-- alter.sql : test emaj_alter_group() and emaj_alter_groups() functions
--
-- set sequence restart value
alter sequence emaj.emaj_hist_hist_id_seq restart 6000;
alter sequence emaj.emaj_time_stamp_time_id_seq restart 6000;
alter sequence emaj.emaj_mark_mark_id_seq restart 6000;
alter sequence emaj.emaj_rlbk_rlbk_id_seq restart 6000;
-----------------------------
-- stop, reset and drop groups
-----------------------------
select emaj.emaj_stop_group('myGroup1');
 emaj_stop_group 
-----------------
               7
(1 row)

select emaj.emaj_reset_group('myGroup1');
 emaj_reset_group 
------------------
                7
(1 row)

select emaj.emaj_drop_group('myGroup1');
 emaj_drop_group 
-----------------
               7
(1 row)

select emaj.emaj_force_drop_group('myGroup2');
 emaj_force_drop_group 
-----------------------
                     8
(1 row)

select emaj.emaj_stop_group('phil''s group#3",','Simple stop mark');
 emaj_stop_group 
-----------------
               4
(1 row)

select emaj.emaj_drop_group('phil''s group#3",');
 emaj_drop_group 
-----------------
               4
(1 row)

select emaj.emaj_force_stop_group('myGroup4');
 emaj_force_stop_group 
-----------------------
                     5
(1 row)

select emaj.emaj_drop_group('myGroup4');
 emaj_drop_group 
-----------------
               5
(1 row)

select emaj.emaj_force_stop_group('emptyGroup');
 emaj_force_stop_group 
-----------------------
                     0
(1 row)

select emaj.emaj_drop_group('emptyGroup');
 emaj_drop_group 
-----------------
               0
(1 row)

-----------------------------
-- emaj_alter_group() tests
-----------------------------
select emaj.emaj_create_group('myGroup1');
NOTICE:  table "myschema1_myTbl3_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema1.myTbl3" does not exist, skipping
NOTICE:  trigger "emaj_trunc_trg" for relation "myschema1.myTbl3" does not exist, skipping
NOTICE:  table "myschema1_mytbl1_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema1.mytbl1" does not exist, skipping
NOTICE:  trigger "emaj_trunc_trg" for relation "myschema1.mytbl1" does not exist, skipping
NOTICE:  table "myschema1_mytbl4_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema1.mytbl4" does not exist, skipping
NOTICE:  trigger "emaj_trunc_trg" for relation "myschema1.mytbl4" does not exist, skipping
NOTICE:  table "myschema1_mytbl2_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema1.mytbl2" does not exist, skipping
NOTICE:  trigger "emaj_trunc_trg" for relation "myschema1.mytbl2" does not exist, skipping
WARNING:  _create_tbl: table "myschema1.mytbl2" has triggers (mytbl2trg). Verify the compatibility with emaj rollback operations (in particular if triggers update one or several other tables). Triggers may have to be manualy disabled before rollback.
NOTICE:  table "myschema1_mytbl2b_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema1.mytbl2b" does not exist, skipping
NOTICE:  trigger "emaj_trunc_trg" for relation "myschema1.mytbl2b" does not exist, skipping
 emaj_create_group 
-------------------
                 7
(1 row)

select emaj.emaj_create_group('myGroup2');
NOTICE:  table "myschema2_mytbl1_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema2.mytbl1" does not exist, skipping
NOTICE:  trigger "emaj_trunc_trg" for relation "myschema2.mytbl1" does not exist, skipping
NOTICE:  table "myschema2_mytbl2_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema2.mytbl2" does not exist, skipping
NOTICE:  trigger "emaj_trunc_trg" for relation "myschema2.mytbl2" does not exist, skipping
NOTICE:  table "myschema2_myTbl3_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema2.myTbl3" does not exist, skipping
NOTICE:  trigger "emaj_trunc_trg" for relation "myschema2.myTbl3" does not exist, skipping
NOTICE:  table "myschema2_mytbl4_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema2.mytbl4" does not exist, skipping
NOTICE:  trigger "emaj_trunc_trg" for relation "myschema2.mytbl4" does not exist, skipping
NOTICE:  table "otherPrefix4mytbl5_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema2.mytbl5" does not exist, skipping
NOTICE:  trigger "emaj_trunc_trg" for relation "myschema2.mytbl5" does not exist, skipping
NOTICE:  table "myschema2_mytbl6_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema2.mytbl6" does not exist, skipping
NOTICE:  trigger "emaj_trunc_trg" for relation "myschema2.mytbl6" does not exist, skipping
WARNING:  _check_fk_groups: Foreign key "mytbl6_col61_fkey", from table "myschema2.mytbl6", references "myschema2.mytbl7" that is outside groups (myGroup2).
WARNING:  _check_fk_groups: table "myschema2.mytbl6" is referenced by foreign key "mytbl8_col81_fkey" from table "myschema2.mytbl8" that is outside groups (myGroup2).
 emaj_create_group 
-------------------
                 8
(1 row)

select emaj.emaj_create_group('emptyGroup',true,true);
 emaj_create_group 
-------------------
                 0
(1 row)

select emaj.emaj_create_group('myGroup4');
NOTICE:  table "myschema4_mypartp1_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema4.mypartp1" does not exist, skipping
NOTICE:  trigger "emaj_trunc_trg" for relation "myschema4.mypartp1" does not exist, skipping
NOTICE:  table "myschema4_mypartp2_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema4.mypartp2" does not exist, skipping
NOTICE:  trigger "emaj_trunc_trg" for relation "myschema4.mypartp2" does not exist, skipping
NOTICE:  table "myschema4_mytblc1_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema4.mytblc1" does not exist, skipping
NOTICE:  trigger "emaj_trunc_trg" for relation "myschema4.mytblc1" does not exist, skipping
NOTICE:  table "myschema4_mytblc2_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema4.mytblc2" does not exist, skipping
NOTICE:  trigger "emaj_trunc_trg" for relation "myschema4.mytblc2" does not exist, skipping
NOTICE:  table "myschema4_mytblm_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema4.mytblm" does not exist, skipping
NOTICE:  trigger "emaj_trunc_trg" for relation "myschema4.mytblm" does not exist, skipping
WARNING:  _create_tbl: table "myschema4.mytblm" has triggers (mytblm_insert_trigger). Verify the compatibility with emaj rollback operations (in particular if triggers update one or several other tables). Triggers may have to be manualy disabled before rollback.
 emaj_create_group 
-------------------
                 5
(1 row)

-- unknown group
select emaj.emaj_alter_group(NULL);
ERROR:  _alter_groups: the group "<NULL>" has not been created.
CONTEXT:  PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 20 at RAISE
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
select emaj.emaj_alter_group('unknownGroup');
ERROR:  _alter_groups: the group "unknownGroup" has not been created.
CONTEXT:  PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 20 at RAISE
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
-- group in logging state
begin;
  select emaj.emaj_start_group('myGroup1','');
 emaj_start_group 
------------------
                7
(1 row)

  select emaj.emaj_disable_protection_by_event_triggers();
 emaj_disable_protection_by_event_triggers 
-------------------------------------------
                                         3
(1 row)

  drop table emaj.myschema1_mytbl1_log;
  select emaj.emaj_enable_protection_by_event_triggers();
 emaj_enable_protection_by_event_triggers 
------------------------------------------
                                        3
(1 row)

  select emaj.emaj_alter_group('myGroup1');
ERROR:  _alter_plan: the groups "myGroup1" cannot be altered because they are in LOGGING state.
CONTEXT:  PL/pgSQL function emaj._alter_plan(text[],bigint) line 126 at RAISE
SQL statement "SELECT emaj._alter_plan(v_groupNames, v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 45 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
rollback;
-- alter a group with a table now already belonging to another group
begin;
  insert into emaj.emaj_group_def values ('myGroup1','myschema2','mytbl1');
  select emaj.emaj_alter_group('myGroup1');
WARNING:  _check_groups_content: Error, the table or sequence myschema2.mytbl1 belongs to another group (myGroup2).
WARNING:  _check_groups_content: Error, the emaj prefix "myschema2_mytbl1" is already used.
ERROR:  _check_groups_content: one or several errors have been detected in the emaj_group_def table content.
CONTEXT:  PL/pgSQL function emaj._check_groups_content(text[],boolean) line 190 at RAISE
SQL statement "SELECT emaj._check_groups_content(v_groupNames, NULL)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 24 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
rollback;
-- schema suffix cannot be changed for sequence
begin;
  update emaj.emaj_group_def set grpdef_log_schema_suffix = 'dummy' where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3_col31_seq';
  select emaj.emaj_alter_group('myGroup1');
WARNING:  _check_groups_content: Error, for the sequence myschema1."myTbl3_col31_seq", the secondary log schema suffix is not NULL.
ERROR:  _check_groups_content: one or several errors have been detected in the emaj_group_def table content.
CONTEXT:  PL/pgSQL function emaj._check_groups_content(text[],boolean) line 190 at RAISE
SQL statement "SELECT emaj._check_groups_content(v_groupNames, NULL)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 24 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
rollback;
-- object names prefix cannot be changed for sequence
begin;
  update emaj.emaj_group_def set grpdef_emaj_names_prefix = 'dummy' where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3_col31_seq';
  select emaj.emaj_alter_group('myGroup1');
WARNING:  _check_groups_content: Error, for the sequence myschema1."myTbl3_col31_seq", the emaj names prefix is not NULL.
ERROR:  _check_groups_content: one or several errors have been detected in the emaj_group_def table content.
CONTEXT:  PL/pgSQL function emaj._check_groups_content(text[],boolean) line 190 at RAISE
SQL statement "SELECT emaj._check_groups_content(v_groupNames, NULL)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 24 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
rollback;
-- log tablespace cannot be changed for sequence
begin;
  update emaj.emaj_group_def set grpdef_log_dat_tsp = 'b' where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3_col31_seq';
  select emaj.emaj_alter_group('myGroup1');
WARNING:  _check_groups_content: Error, for the sequence myschema1."myTbl3_col31_seq", the data log tablespace is not NULL.
ERROR:  _check_groups_content: one or several errors have been detected in the emaj_group_def table content.
CONTEXT:  PL/pgSQL function emaj._check_groups_content(text[],boolean) line 190 at RAISE
SQL statement "SELECT emaj._check_groups_content(v_groupNames, NULL)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 24 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
rollback;
begin;
  update emaj.emaj_group_def set grpdef_log_idx_tsp = 'b' where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3_col31_seq';
  select emaj.emaj_alter_group('myGroup1');
WARNING:  _check_groups_content: Error, for the sequence myschema1."myTbl3_col31_seq", the index log tablespace is not NULL.
ERROR:  _check_groups_content: one or several errors have been detected in the emaj_group_def table content.
CONTEXT:  PL/pgSQL function emaj._check_groups_content(text[],boolean) line 190 at RAISE
SQL statement "SELECT emaj._check_groups_content(v_groupNames, NULL)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 24 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
rollback;
-- dropped application table
begin;
  select emaj.emaj_disable_protection_by_event_triggers();
 emaj_disable_protection_by_event_triggers 
-------------------------------------------
                                         3
(1 row)

  drop table myschema1.mytbl2b;
  select emaj.emaj_enable_protection_by_event_triggers();
 emaj_enable_protection_by_event_triggers 
------------------------------------------
                                        3
(1 row)

  select emaj.emaj_alter_group('myGroup1');
WARNING:  _check_groups_content: Error, the table or sequence myschema1.mytbl2b does not exist.
WARNING:  _check_groups_content: Error, the table or sequence myschema1.mytbl2b_col20_seq does not exist.
ERROR:  _check_groups_content: one or several errors have been detected in the emaj_group_def table content.
CONTEXT:  PL/pgSQL function emaj._check_groups_content(text[],boolean) line 190 at RAISE
SQL statement "SELECT emaj._check_groups_content(v_groupNames, NULL)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 24 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
rollback;
-- should be OK
-- nothing to change
select group_name, group_is_logging, group_is_rlbk_protected, group_nb_table, group_nb_sequence, group_is_rollbackable,
       group_creation_time_id, group_last_alter_time_id, group_comment
 from emaj.emaj_group where group_name = 'myGroup1';
 group_name | group_is_logging | group_is_rlbk_protected | group_nb_table | group_nb_sequence | group_is_rollbackable | group_creation_time_id | group_last_alter_time_id | group_comment 
------------+------------------+-------------------------+----------------+-------------------+-----------------------+------------------------+--------------------------+---------------
 myGroup1   | f                | f                       |              5 |                 2 | t                     |                   6002 |                          | 
(1 row)

select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

select group_name, group_is_logging, group_is_rlbk_protected, group_nb_table, group_nb_sequence, group_is_rollbackable,
       group_creation_time_id, group_last_alter_time_id, group_comment
 from emaj.emaj_group where group_name = 'myGroup1';
 group_name | group_is_logging | group_is_rlbk_protected | group_nb_table | group_nb_sequence | group_is_rollbackable | group_creation_time_id | group_last_alter_time_id | group_comment 
------------+------------------+-------------------------+----------------+-------------------+-----------------------+------------------------+--------------------------+---------------
 myGroup1   | f                | f                       |              5 |                 2 | t                     |                   6002 |                     6008 | 
(1 row)

select nspname from pg_namespace where nspname like 'emaj%' order by nspname;
 nspname 
---------
 emaj
 emajC
 emajb
(3 rows)

-- only 3 tables to remove (+ log schemas emajb)
delete from emaj.emaj_group_def where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl2b';
delete from emaj.emaj_group_def where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3';
delete from emaj.emaj_group_def where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl4';
select emaj.emaj_alter_group('myGroup1');
WARNING:  _check_fk_groups: table "myschema1.mytbl2" is referenced by foreign key "mytbl4_col43_fkey" from table "myschema1.mytbl4" that is outside groups (myGroup1).
WARNING:  _check_fk_groups: table "myschema1.mytbl1" is referenced by foreign key "mytbl4_col44_fkey" from table "myschema1.mytbl4" that is outside groups (myGroup1).
 emaj_alter_group 
------------------
                4
(1 row)

select group_nb_table, group_nb_sequence from emaj.emaj_group where group_name = 'myGroup1';
 group_nb_table | group_nb_sequence 
----------------+-------------------
              2 |                 2
(1 row)

select nspname from pg_namespace where nspname like 'emaj%' order by nspname;
 nspname 
---------
 emaj
 emajC
(2 rows)

-- only 1 sequence to remove
delete from emaj.emaj_group_def where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3_col31_seq';
select emaj.emaj_alter_group('myGroup1');
WARNING:  _check_fk_groups: table "myschema1.mytbl2" is referenced by foreign key "mytbl4_col43_fkey" from table "myschema1.mytbl4" that is outside groups (myGroup1).
WARNING:  _check_fk_groups: table "myschema1.mytbl1" is referenced by foreign key "mytbl4_col44_fkey" from table "myschema1.mytbl4" that is outside groups (myGroup1).
 emaj_alter_group 
------------------
                3
(1 row)

select group_nb_table, group_nb_sequence from emaj.emaj_group where group_name = 'myGroup1';
 group_nb_table | group_nb_sequence 
----------------+-------------------
              2 |                 1
(1 row)

-- 3 tables to add (+ log schemas emajb)
insert into emaj.emaj_group_def values ('myGroup1','myschema1','mytbl2b',NULL,'b',NULL,'tsp log''2','tsp log''2');
insert into emaj.emaj_group_def values ('myGroup1','myschema1','myTbl3',10,'C',NULL,'tsplog1');
insert into emaj.emaj_group_def values ('myGroup1','myschema1','mytbl4',20,NULL,NULL,'tsplog1','tsp log''2');
select emaj.emaj_alter_group('myGroup1');
NOTICE:  table "myschema1_myTbl3_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema1.myTbl3" does not exist, skipping
NOTICE:  trigger "emaj_trunc_trg" for relation "myschema1.myTbl3" does not exist, skipping
NOTICE:  table "myschema1_mytbl4_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema1.mytbl4" does not exist, skipping
NOTICE:  trigger "emaj_trunc_trg" for relation "myschema1.mytbl4" does not exist, skipping
NOTICE:  table "myschema1_mytbl2b_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema1.mytbl2b" does not exist, skipping
NOTICE:  trigger "emaj_trunc_trg" for relation "myschema1.mytbl2b" does not exist, skipping
 emaj_alter_group 
------------------
                6
(1 row)

select group_nb_table, group_nb_sequence from emaj.emaj_group where group_name = 'myGroup1';
 group_nb_table | group_nb_sequence 
----------------+-------------------
              5 |                 1
(1 row)

select nspname from pg_namespace where nspname like 'emaj%' order by nspname;
 nspname 
---------
 emaj
 emajC
 emajb
(3 rows)

-- only 1 sequence to add
insert into emaj.emaj_group_def values ('myGroup1','myschema1','myTbl3_col31_seq',1);
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

select group_nb_table, group_nb_sequence from emaj.emaj_group where group_name = 'myGroup1';
 group_nb_table | group_nb_sequence 
----------------+-------------------
              5 |                 2
(1 row)

-- only change the log schema
update emaj.emaj_group_def set grpdef_log_schema_suffix = NULL where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3';
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

select nspname from pg_namespace, pg_class where relnamespace = pg_namespace.oid and relname = 'myschema1_myTbl3_log';
 nspname 
---------
 emaj
(1 row)

update emaj.emaj_group_def set grpdef_log_schema_suffix = 'C' where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3';
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

select nspname from pg_namespace, pg_class where relnamespace = pg_namespace.oid and relname = 'myschema1_myTbl3_log';
 nspname 
---------
 emajC
(1 row)

-- only change the emaj_names_prefix for 1 table
update emaj.emaj_group_def set grpdef_emaj_names_prefix = 's1t3' where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3';
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

select count(*) from "emajC".s1t3_log;
 count 
-------
     0
(1 row)

update emaj.emaj_group_def set grpdef_emaj_names_prefix = NULL where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3';
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

select count(*) from "emajC"."myschema1_myTbl3_log";
 count 
-------
     0
(1 row)

-- only change the log data tablespace for 1 table
update emaj.emaj_group_def set grpdef_log_dat_tsp = NULL where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl2b';
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

select spcname from pg_tablespace, pg_class where reltablespace = pg_tablespace.oid and relname = 'myschema1_mytbl2b_log';
 spcname 
---------
(0 rows)

update emaj.emaj_group_def set grpdef_log_dat_tsp = 'tsp log''2' where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl2b';
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

select spcname from pg_tablespace, pg_class where reltablespace = pg_tablespace.oid and relname = 'myschema1_mytbl2b_log';
  spcname  
-----------
 tsp log'2
(1 row)

-- change the log data tablespace for all tables of a group
update emaj.emaj_group_def set grpdef_log_dat_tsp = case when grpdef_log_dat_tsp is NULL then 'tsplog1' when grpdef_log_dat_tsp = 'tsplog1' then 'tsp log''2' else NULL end where grpdef_schema = 'myschema1' and grpdef_tblseq not like '%seq';
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

update emaj.emaj_group_def set grpdef_log_dat_tsp = case when grpdef_log_dat_tsp = 'tsplog1' then NULL when grpdef_log_dat_tsp = 'tsp log''2' then 'tsplog1' else 'tsp log''2' end where grpdef_schema = 'myschema1' and grpdef_tblseq not like '%seq';
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

-- only change the log index tablespace, using a session default tablespace
update emaj.emaj_group_def set grpdef_log_idx_tsp = NULL where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl2b';
set default_tablespace = tspemaj_renamed;
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

reset default_tablespace;
select spcname from pg_tablespace, pg_class where reltablespace = pg_tablespace.oid and relname = 'myschema1_mytbl2b_log_idx';
     spcname     
-----------------
 tspemaj_renamed
(1 row)

update emaj.emaj_group_def set grpdef_log_idx_tsp = 'tsp log''2' where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl2b';
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

select spcname from pg_tablespace, pg_class where reltablespace = pg_tablespace.oid and relname = 'myschema1_mytbl2b_log_idx';
  spcname  
-----------
 tsp log'2
(1 row)

-- only change the priority
update emaj.emaj_group_def set grpdef_priority = 30 where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl1';
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

select rel_priority from emaj.emaj_relation where rel_schema = 'myschema1' and rel_tblseq = 'mytbl1';
 rel_priority 
--------------
           30
(1 row)

update emaj.emaj_group_def set grpdef_priority = NULL where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl1';
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

select rel_priority from emaj.emaj_relation where rel_schema = 'myschema1' and rel_tblseq = 'mytbl1';
 rel_priority 
--------------
             
(1 row)

update emaj.emaj_group_def set grpdef_priority = 20 where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl1';
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

select rel_priority from emaj.emaj_relation where rel_schema = 'myschema1' and rel_tblseq = 'mytbl1';
 rel_priority 
--------------
           20
(1 row)

-- change the table structure
alter table myschema1.mytbl1 add column newcol int;
select emaj.emaj_alter_group('myGroup1');
NOTICE:  table "myschema1_mytbl1_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema1.mytbl1" does not exist, skipping
NOTICE:  trigger "emaj_trunc_trg" for relation "myschema1.mytbl1" does not exist, skipping
 emaj_alter_group 
------------------
                7
(1 row)

alter table myschema1.mytbl1 rename newcol to newcol2;
select emaj.emaj_alter_group('myGroup1');
NOTICE:  table "myschema1_mytbl1_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema1.mytbl1" does not exist, skipping
NOTICE:  trigger "emaj_trunc_trg" for relation "myschema1.mytbl1" does not exist, skipping
 emaj_alter_group 
------------------
                7
(1 row)

alter table myschema1.mytbl1 alter column newcol2 type bigint;
select emaj.emaj_alter_group('myGroup1');
NOTICE:  table "myschema1_mytbl1_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema1.mytbl1" does not exist, skipping
NOTICE:  trigger "emaj_trunc_trg" for relation "myschema1.mytbl1" does not exist, skipping
 emaj_alter_group 
------------------
                7
(1 row)

alter table myschema1.mytbl1 alter column newcol2 set default 0;
-- NB: changing default has no impact on emaj component 
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

alter table myschema1.mytbl1 drop column newcol2;
select emaj.emaj_alter_group('myGroup1');
NOTICE:  table "myschema1_mytbl1_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema1.mytbl1" does not exist, skipping
NOTICE:  trigger "emaj_trunc_trg" for relation "myschema1.mytbl1" does not exist, skipping
 emaj_alter_group 
------------------
                7
(1 row)

-- rename a table and/or change its schema
alter table myschema1.mytbl1 rename to mytbl1_new_name;
update emaj.emaj_group_def set grpdef_tblseq = 'mytbl1_new_name' 
  where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl1';
select emaj.emaj_alter_group('myGroup1');
NOTICE:  drop cascades to trigger emaj_log_trg on table myschema1.mytbl1_new_name
NOTICE:  table "myschema1_mytbl1_new_name_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema1.mytbl1_new_name" does not exist, skipping
 emaj_alter_group 
------------------
                7
(1 row)

alter table myschema1.mytbl1_new_name set schema public;
update emaj.emaj_group_def set grpdef_schema = 'public'
  where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl1_new_name';
select emaj.emaj_alter_group('myGroup1');
NOTICE:  drop cascades to trigger emaj_log_trg on table mytbl1_new_name
NOTICE:  table "public_mytbl1_new_name_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "public.mytbl1_new_name" does not exist, skipping
 emaj_alter_group 
------------------
                7
(1 row)

alter table public.mytbl1_new_name rename to mytbl1;
alter table public.mytbl1 set schema myschema1;
update emaj.emaj_group_def set grpdef_schema = 'myschema1', grpdef_tblseq = 'mytbl1'
  where grpdef_schema = 'public' and grpdef_tblseq = 'mytbl1_new_name';
-- the next call gives a useless mark name parameter (the group is in idle state)
select emaj.emaj_alter_group('myGroup1','useless_mark_name');
NOTICE:  drop cascades to trigger emaj_log_trg on table myschema1.mytbl1
NOTICE:  table "myschema1_mytbl1_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema1.mytbl1" does not exist, skipping
 emaj_alter_group 
------------------
                7
(1 row)

-- missing emaj components
select emaj.emaj_disable_protection_by_event_triggers();
 emaj_disable_protection_by_event_triggers 
-------------------------------------------
                                         3
(1 row)

drop trigger emaj_log_trg on myschema1.mytbl1;
select emaj.emaj_alter_group('myGroup1');
NOTICE:  trigger "emaj_log_trg" for relation "myschema1.mytbl1" does not exist, skipping
NOTICE:  table "myschema1_mytbl1_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema1.mytbl1" does not exist, skipping
NOTICE:  trigger "emaj_trunc_trg" for relation "myschema1.mytbl1" does not exist, skipping
 emaj_alter_group 
------------------
                7
(1 row)

drop function emaj.myschema1_mytbl1_log_fnct() cascade;
NOTICE:  drop cascades to trigger emaj_log_trg on table myschema1.mytbl1
select emaj.emaj_alter_group('myGroup1');
NOTICE:  trigger "emaj_log_trg" for relation "myschema1.mytbl1" does not exist, skipping
NOTICE:  function emaj.myschema1_mytbl1_log_fnct() does not exist, skipping
NOTICE:  table "myschema1_mytbl1_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema1.mytbl1" does not exist, skipping
NOTICE:  trigger "emaj_trunc_trg" for relation "myschema1.mytbl1" does not exist, skipping
 emaj_alter_group 
------------------
                7
(1 row)

drop table emaj.myschema1_mytbl1_log;
select emaj.emaj_alter_group('myGroup1');
NOTICE:  table "myschema1_mytbl1_log" does not exist, skipping
NOTICE:  table "myschema1_mytbl1_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema1.mytbl1" does not exist, skipping
NOTICE:  trigger "emaj_trunc_trg" for relation "myschema1.mytbl1" does not exist, skipping
 emaj_alter_group 
------------------
                7
(1 row)

select emaj.emaj_enable_protection_by_event_triggers();
 emaj_enable_protection_by_event_triggers 
------------------------------------------
                                        3
(1 row)

-- multiple emaj_alter_group() on a logging group => fails
-- this test is commented because the generated error message differs from one run to another
--begin;
--  select emaj.emaj_start_group('myGroup4');
--  select emaj.emaj_alter_group('myGroup4');
--  select emaj.emaj_alter_group('myGroup4');
--rollback;
-----------------------------
-- emaj_alter_groups() tests
-----------------------------
-- unknown groups
select emaj.emaj_alter_groups('{NULL,"unknownGroup"}');
ERROR:  _alter_groups: the group "<NULL>" has not been created.
CONTEXT:  PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 20 at RAISE
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
select emaj.emaj_alter_groups('{"myGroup1","unknownGroup"}');
ERROR:  _alter_groups: the group "unknownGroup" has not been created.
CONTEXT:  PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 20 at RAISE
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
-- groups in logging state
begin;
  select emaj.emaj_start_groups('{"myGroup1","myGroup2"}','');
WARNING:  _check_fk_groups: Foreign key "mytbl6_col61_fkey", from table "myschema2.mytbl6", references "myschema2.mytbl7" that is outside groups (myGroup1,myGroup2).
WARNING:  _check_fk_groups: table "myschema2.mytbl6" is referenced by foreign key "mytbl8_col81_fkey" from table "myschema2.mytbl8" that is outside groups (myGroup1,myGroup2).
 emaj_start_groups 
-------------------
                15
(1 row)

  select emaj.emaj_disable_protection_by_event_triggers();
 emaj_disable_protection_by_event_triggers 
-------------------------------------------
                                         3
(1 row)

  drop table emaj.myschema1_mytbl1_log;
  drop table emaj.myschema2_mytbl1_log;
  select emaj.emaj_enable_protection_by_event_triggers();
 emaj_enable_protection_by_event_triggers 
------------------------------------------
                                        3
(1 row)

  select emaj.emaj_alter_groups('{"myGroup2","myGroup1"}');
ERROR:  _alter_plan: the groups "myGroup2, myGroup1" cannot be altered because they are in LOGGING state.
CONTEXT:  PL/pgSQL function emaj._alter_plan(text[],bigint) line 126 at RAISE
SQL statement "SELECT emaj._alter_plan(v_groupNames, v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 45 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
rollback;
-- alter groups with a table now already belonging to another group
begin;
  insert into emaj.emaj_group_def values ('myGroup1','myschema2','mytbl1');
  select emaj.emaj_alter_groups('{"myGroup1","myGroup2"}');
WARNING:  _check_groups_content: Error, the emaj prefix "myschema2_mytbl1" is configured for several tables in the groups.
ERROR:  _check_groups_content: one or several errors have been detected in the emaj_group_def table content.
CONTEXT:  PL/pgSQL function emaj._check_groups_content(text[],boolean) line 190 at RAISE
SQL statement "SELECT emaj._check_groups_content(v_groupNames, NULL)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 24 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
rollback;
-- schema suffix cannot be changed for sequence (this covers other cases of forbidden changes for sequences)
begin;
  update emaj.emaj_group_def set grpdef_log_schema_suffix = 'dummy' where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3_col31_seq';
  select emaj.emaj_alter_groups('{"myGroup1","myGroup2"}');
WARNING:  _check_groups_content: Error, for the sequence myschema1."myTbl3_col31_seq", the secondary log schema suffix is not NULL.
ERROR:  _check_groups_content: one or several errors have been detected in the emaj_group_def table content.
CONTEXT:  PL/pgSQL function emaj._check_groups_content(text[],boolean) line 190 at RAISE
SQL statement "SELECT emaj._check_groups_content(v_groupNames, NULL)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 24 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
rollback;
-- a PRIMARY KEY is missing
begin;
  alter table myschema1.mytbl4 drop constraint mytbl4_pkey;
  select emaj.emaj_alter_groups('{"myGroup1","myGroup2"}');
WARNING:  _check_groups_content: Error, the table myschema1.mytbl4 has no PRIMARY KEY.
ERROR:  _check_groups_content: one or several errors have been detected in the emaj_group_def table content.
CONTEXT:  PL/pgSQL function emaj._check_groups_content(text[],boolean) line 190 at RAISE
SQL statement "SELECT emaj._check_groups_content(v_groupNames, NULL)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 24 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
rollback;
-- should be OK
-- 3 tables and 1 sequence to remove (+ log schemas emajb)
select group_name, group_nb_table, group_nb_sequence from emaj.emaj_group where group_name = 'myGroup1' or group_name = 'myGroup2' order by 1;
 group_name | group_nb_table | group_nb_sequence 
------------+----------------+-------------------
 myGroup1   |              5 |                 2
 myGroup2   |              6 |                 2
(2 rows)

delete from emaj.emaj_group_def where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl2b';
delete from emaj.emaj_group_def where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3';
delete from emaj.emaj_group_def where grpdef_schema = 'myschema2' and grpdef_tblseq = 'mytbl4';
delete from emaj.emaj_group_def where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3_col31_seq';
select emaj.emaj_alter_groups('{"myGroup1","myGroup2"}');
WARNING:  _check_fk_groups: Foreign key "mytbl6_col61_fkey", from table "myschema2.mytbl6", references "myschema2.mytbl7" that is outside groups (myGroup1,myGroup2).
WARNING:  _check_fk_groups: table "myschema2.mytbl2" is referenced by foreign key "mytbl4_col43_fkey" from table "myschema2.mytbl4" that is outside groups (myGroup1,myGroup2).
WARNING:  _check_fk_groups: table "myschema2.mytbl1" is referenced by foreign key "mytbl4_col44_fkey" from table "myschema2.mytbl4" that is outside groups (myGroup1,myGroup2).
WARNING:  _check_fk_groups: table "myschema2.mytbl6" is referenced by foreign key "mytbl8_col81_fkey" from table "myschema2.mytbl8" that is outside groups (myGroup1,myGroup2).
 emaj_alter_groups 
-------------------
                11
(1 row)

select group_name, group_nb_table, group_nb_sequence from emaj.emaj_group where group_name = 'myGroup1' or group_name = 'myGroup2' order by 1;
 group_name | group_nb_table | group_nb_sequence 
------------+----------------+-------------------
 myGroup1   |              3 |                 1
 myGroup2   |              5 |                 2
(2 rows)

select nspname from pg_namespace where nspname like 'emaj%' order by nspname;
 nspname 
---------
 emaj
 emajC
(2 rows)

-- 3 tables and 1 sequence to add (+ log schemas emajb)
insert into emaj.emaj_group_def values ('myGroup1','myschema1','mytbl2b',NULL,'b',NULL,'tsp log''2','tsp log''2');
insert into emaj.emaj_group_def values ('myGroup1','myschema1','myTbl3',10,'C',NULL,'tsplog1');
insert into emaj.emaj_group_def values ('myGroup2','myschema2','mytbl4',NULL,NULL,'myschema2_mytbl4');
insert into emaj.emaj_group_def values ('myGroup1','myschema1','myTbl3_col31_seq',1);
select emaj.emaj_alter_groups('{"myGroup1","myGroup2"}');
NOTICE:  table "myschema1_myTbl3_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema1.myTbl3" does not exist, skipping
NOTICE:  trigger "emaj_trunc_trg" for relation "myschema1.myTbl3" does not exist, skipping
NOTICE:  table "myschema1_mytbl2b_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema1.mytbl2b" does not exist, skipping
NOTICE:  trigger "emaj_trunc_trg" for relation "myschema1.mytbl2b" does not exist, skipping
NOTICE:  table "myschema2_mytbl4_log" does not exist, skipping
NOTICE:  trigger "emaj_log_trg" for relation "myschema2.mytbl4" does not exist, skipping
NOTICE:  trigger "emaj_trunc_trg" for relation "myschema2.mytbl4" does not exist, skipping
WARNING:  _check_fk_groups: Foreign key "mytbl6_col61_fkey", from table "myschema2.mytbl6", references "myschema2.mytbl7" that is outside groups (myGroup1,myGroup2).
WARNING:  _check_fk_groups: table "myschema2.mytbl6" is referenced by foreign key "mytbl8_col81_fkey" from table "myschema2.mytbl8" that is outside groups (myGroup1,myGroup2).
 emaj_alter_groups 
-------------------
                15
(1 row)

select group_name, group_nb_table, group_nb_sequence from emaj.emaj_group where group_name = 'myGroup1' or group_name = 'myGroup2' order by 1;
 group_name | group_nb_table | group_nb_sequence 
------------+----------------+-------------------
 myGroup1   |              5 |                 2
 myGroup2   |              6 |                 2
(2 rows)

select nspname from pg_namespace where nspname like 'emaj%' order by nspname;
 nspname 
---------
 emaj
 emajC
 emajb
(3 rows)

-- change a log schema and the emaj_names_prefix for 2 tables
update emaj.emaj_group_def set grpdef_log_schema_suffix = NULL where grpdef_schema = 'myschema2' and grpdef_tblseq = 'myTbl3';
update emaj.emaj_group_def set grpdef_emaj_names_prefix = 's1t3' where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3';
select emaj.emaj_alter_groups('{"myGroup1","myGroup2"}');
WARNING:  _check_fk_groups: Foreign key "mytbl6_col61_fkey", from table "myschema2.mytbl6", references "myschema2.mytbl7" that is outside groups (myGroup1,myGroup2).
WARNING:  _check_fk_groups: table "myschema2.mytbl6" is referenced by foreign key "mytbl8_col81_fkey" from table "myschema2.mytbl8" that is outside groups (myGroup1,myGroup2).
 emaj_alter_groups 
-------------------
                15
(1 row)

select nspname from pg_namespace, pg_class where relnamespace = pg_namespace.oid and relname = 'myschema2_myTbl3_log';
 nspname 
---------
 emaj
(1 row)

select count(*) from "emajC".s1t3_log;
 count 
-------
     0
(1 row)

--
update emaj.emaj_group_def set grpdef_log_schema_suffix = 'C' where grpdef_schema = 'myschema2' and grpdef_tblseq = 'myTbl3';
update emaj.emaj_group_def set grpdef_emaj_names_prefix = NULL where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3';
select emaj.emaj_alter_groups('{"myGroup1","myGroup2"}');
WARNING:  _check_fk_groups: Foreign key "mytbl6_col61_fkey", from table "myschema2.mytbl6", references "myschema2.mytbl7" that is outside groups (myGroup1,myGroup2).
WARNING:  _check_fk_groups: table "myschema2.mytbl6" is referenced by foreign key "mytbl8_col81_fkey" from table "myschema2.mytbl8" that is outside groups (myGroup1,myGroup2).
 emaj_alter_groups 
-------------------
                15
(1 row)

select nspname from pg_namespace, pg_class where relnamespace = pg_namespace.oid and relname = 'myschema2_myTbl3_log';
 nspname 
---------
 emajC
(1 row)

select count(*) from "emajC"."myschema1_myTbl3_log";
 count 
-------
     0
(1 row)

-- only change the log data tablespace for 1 table, the log index tablespace for another table and the priority for a third one
update emaj.emaj_group_def set grpdef_log_dat_tsp = NULL where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl2b';
update emaj.emaj_group_def set grpdef_log_idx_tsp = 'tsplog1' where grpdef_schema = 'myschema2' and grpdef_tblseq = 'mytbl6';
update emaj.emaj_group_def set grpdef_priority = 30 where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl1';
set default_tablespace = tspemaj_renamed;
select emaj.emaj_alter_groups('{"myGroup1","myGroup2"}');
WARNING:  _check_fk_groups: Foreign key "mytbl6_col61_fkey", from table "myschema2.mytbl6", references "myschema2.mytbl7" that is outside groups (myGroup1,myGroup2).
WARNING:  _check_fk_groups: table "myschema2.mytbl6" is referenced by foreign key "mytbl8_col81_fkey" from table "myschema2.mytbl8" that is outside groups (myGroup1,myGroup2).
 emaj_alter_groups 
-------------------
                15
(1 row)

reset default_tablespace;
select spcname from pg_tablespace, pg_class where reltablespace = pg_tablespace.oid and relname = 'myschema1_mytbl2b_log';
     spcname     
-----------------
 tspemaj_renamed
(1 row)

select spcname from pg_tablespace, pg_class where reltablespace = pg_tablespace.oid and relname = 'myschema2_mytbl6_log_idx';
 spcname 
---------
 tsplog1
(1 row)

select rel_priority from emaj.emaj_relation where rel_schema = 'myschema1' and rel_tblseq = 'mytbl1';
 rel_priority 
--------------
           30
(1 row)

--
update emaj.emaj_group_def set grpdef_log_dat_tsp = 'tsp log''2' where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl2b';
update emaj.emaj_group_def set grpdef_log_idx_tsp = NULL where grpdef_schema = 'myschema2' and grpdef_tblseq = 'mytbl6';
update emaj.emaj_group_def set grpdef_priority = 20 where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl1';
select emaj.emaj_alter_groups('{"myGroup1","myGroup2"}');
WARNING:  _check_fk_groups: Foreign key "mytbl6_col61_fkey", from table "myschema2.mytbl6", references "myschema2.mytbl7" that is outside groups (myGroup1,myGroup2).
WARNING:  _check_fk_groups: table "myschema2.mytbl6" is referenced by foreign key "mytbl8_col81_fkey" from table "myschema2.mytbl8" that is outside groups (myGroup1,myGroup2).
 emaj_alter_groups 
-------------------
                15
(1 row)

select spcname from pg_tablespace, pg_class where reltablespace = pg_tablespace.oid and relname = 'myschema1_mytbl2b_log';
  spcname  
-----------
 tsp log'2
(1 row)

select spcname from pg_tablespace, pg_class where reltablespace = pg_tablespace.oid and relname = 'myschema2_mytbl6_log_idx';
 spcname 
---------
(0 rows)

select rel_priority from emaj.emaj_relation where rel_schema = 'myschema1' and rel_tblseq = 'mytbl1';
 rel_priority 
--------------
           20
(1 row)

-- move 1 table and 1 sequence from a group to another
update emaj.emaj_group_def set grpdef_group = 'myGroup1' where grpdef_schema = 'myschema2' and grpdef_tblseq = 'myTbl3';
update emaj.emaj_group_def set grpdef_group = 'myGroup1' where grpdef_schema = 'myschema2' and grpdef_tblseq = 'myTbl3_col31_seq';
select rel_group, count(*) from emaj.emaj_relation where rel_group like 'myGroup%' group by 1 order by 1;
 rel_group | count 
-----------+-------
 myGroup1  |     7
 myGroup2  |     8
 myGroup4  |     5
(3 rows)

select emaj.emaj_alter_groups('{"myGroup1","myGroup2"}');
WARNING:  _check_fk_groups: Foreign key "mytbl6_col61_fkey", from table "myschema2.mytbl6", references "myschema2.mytbl7" that is outside groups (myGroup1,myGroup2).
WARNING:  _check_fk_groups: table "myschema2.mytbl6" is referenced by foreign key "mytbl8_col81_fkey" from table "myschema2.mytbl8" that is outside groups (myGroup1,myGroup2).
 emaj_alter_groups 
-------------------
                15
(1 row)

select rel_group, count(*) from emaj.emaj_relation where rel_group like 'myGroup%' group by 1 order by 1;
 rel_group | count 
-----------+-------
 myGroup1  |     9
 myGroup2  |     6
 myGroup4  |     5
(3 rows)

update emaj.emaj_group_def set grpdef_group = 'myGroup2' where grpdef_schema = 'myschema2' and grpdef_tblseq = 'myTbl3';
update emaj.emaj_group_def set grpdef_group = 'myGroup2' where grpdef_schema = 'myschema2' and grpdef_tblseq = 'myTbl3_col31_seq';
-- the next call gives a useless mark name parameter (the group is in idle state)
select emaj.emaj_alter_groups('{"myGroup1","myGroup2"}','useless_mark_name_%');
WARNING:  _check_fk_groups: Foreign key "mytbl6_col61_fkey", from table "myschema2.mytbl6", references "myschema2.mytbl7" that is outside groups (myGroup1,myGroup2).
WARNING:  _check_fk_groups: table "myschema2.mytbl6" is referenced by foreign key "mytbl8_col81_fkey" from table "myschema2.mytbl8" that is outside groups (myGroup1,myGroup2).
 emaj_alter_groups 
-------------------
                15
(1 row)

select rel_group, count(*) from emaj.emaj_relation where rel_group like 'myGroup%' group by 1 order by 1;
 rel_group | count 
-----------+-------
 myGroup1  |     7
 myGroup2  |     8
 myGroup4  |     5
(3 rows)

-- one group is now empty
begin;
  delete from emaj.emaj_group_def where grpdef_group = 'myGroup2';
  select emaj.emaj_alter_groups('{"myGroup1","myGroup2"}');
 emaj_alter_groups 
-------------------
                 7
(1 row)

rollback;
-----------------------------
-- emaj_alter_group() and emaj_alter_groups() tests on logging groups
-----------------------------
select emaj.emaj_start_groups('{"myGroup1","myGroup2"}','Init');
WARNING:  _check_fk_groups: Foreign key "mytbl6_col61_fkey", from table "myschema2.mytbl6", references "myschema2.mytbl7" that is outside groups (myGroup1,myGroup2).
WARNING:  _check_fk_groups: table "myschema2.mytbl6" is referenced by foreign key "mytbl8_col81_fkey" from table "myschema2.mytbl8" that is outside groups (myGroup1,myGroup2).
 emaj_start_groups 
-------------------
                15
(1 row)

-- change the priority
update emaj.emaj_group_def set grpdef_priority = 30 where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl1';
select emaj.emaj_alter_group('myGroup1','Priority Changed');
 emaj_alter_group 
------------------
                7
(1 row)

select rel_priority from emaj.emaj_relation where rel_schema = 'myschema1' and rel_tblseq = 'mytbl1';
 rel_priority 
--------------
           30
(1 row)

update emaj.emaj_group_def set grpdef_priority = 20 where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl1';
select emaj.emaj_alter_groups(array['myGroup1','myGroup2']);
WARNING:  _check_fk_groups: Foreign key "mytbl6_col61_fkey", from table "myschema2.mytbl6", references "myschema2.mytbl7" that is outside groups (myGroup1,myGroup2).
WARNING:  _check_fk_groups: table "myschema2.mytbl6" is referenced by foreign key "mytbl8_col81_fkey" from table "myschema2.mytbl8" that is outside groups (myGroup1,myGroup2).
 emaj_alter_groups 
-------------------
                15
(1 row)

select rel_priority from emaj.emaj_relation where rel_schema = 'myschema1' and rel_tblseq = 'mytbl1';
 rel_priority 
--------------
           20
(1 row)

-- change the emaj names prefix, the log schema, the log data tablespace and the log index tablespace for different tables
update emaj.emaj_group_def set grpdef_log_schema_suffix = NULL where grpdef_schema = 'myschema2' and grpdef_tblseq = 'myTbl3';
update emaj.emaj_group_def set grpdef_emaj_names_prefix = 's1t3' where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3';
update emaj.emaj_group_def set grpdef_log_dat_tsp = NULL where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl2b';
update emaj.emaj_group_def set grpdef_log_idx_tsp = 'tsplog1' where grpdef_schema = 'myschema2' and grpdef_tblseq = 'mytbl6';
set default_tablespace = tspemaj_renamed;
select emaj.emaj_alter_groups('{"myGroup1","myGroup2"}','Attributes_changed');
WARNING:  _check_fk_groups: Foreign key "mytbl6_col61_fkey", from table "myschema2.mytbl6", references "myschema2.mytbl7" that is outside groups (myGroup1,myGroup2).
WARNING:  _check_fk_groups: table "myschema2.mytbl6" is referenced by foreign key "mytbl8_col81_fkey" from table "myschema2.mytbl8" that is outside groups (myGroup1,myGroup2).
 emaj_alter_groups 
-------------------
                15
(1 row)

reset default_tablespace;
select nspname from pg_namespace, pg_class where relnamespace = pg_namespace.oid and relname = 'myschema2_myTbl3_log';
 nspname 
---------
 emaj
(1 row)

select count(*) from "emajC".s1t3_log;
 count 
-------
     0
(1 row)

select * from emaj.emaj_sequence where (sequ_name like '%myTbl3%' or sequ_name like 's1t3%') and sequ_schema like 'emaj%' order by 1,2,3;
 sequ_schema |        sequ_name         | sequ_time_id | sequ_last_val | sequ_start_val | sequ_increment |    sequ_max_val     | sequ_min_val | sequ_cache_val | sequ_is_cycled | sequ_is_called 
-------------+--------------------------+--------------+---------------+----------------+----------------+---------------------+--------------+----------------+----------------+----------------
 emaj        | myschema2_myTbl3_log_seq |         6048 |             1 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | f
 emaj        | myschema2_myTbl3_log_seq |         6050 |             1 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | f
 emaj        | myschema2_myTbl3_log_seq |         6051 |             1 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | f
 emajC       | s1t3_log_seq             |         6048 |             1 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | f
 emajC       | s1t3_log_seq             |         6049 |             1 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | f
 emajC       | s1t3_log_seq             |         6050 |             1 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | f
 emajC       | s1t3_log_seq             |         6051 |             1 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | f
(7 rows)

select spcname from pg_tablespace, pg_class where reltablespace = pg_tablespace.oid and relname = 'myschema1_mytbl2b_log';
     spcname     
-----------------
 tspemaj_renamed
(1 row)

select spcname from pg_tablespace, pg_class where reltablespace = pg_tablespace.oid and relname = 'myschema2_mytbl6_log_idx';
 spcname 
---------
 tsplog1
(1 row)

--
update emaj.emaj_group_def set grpdef_log_schema_suffix = 'C' where grpdef_schema = 'myschema2' and grpdef_tblseq = 'myTbl3';
update emaj.emaj_group_def set grpdef_emaj_names_prefix = NULL where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3';
update emaj.emaj_group_def set grpdef_log_dat_tsp = 'tsp log''2' where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl2b';
update emaj.emaj_group_def set grpdef_log_idx_tsp = NULL where grpdef_schema = 'myschema2' and grpdef_tblseq = 'mytbl6';
select emaj.emaj_alter_groups('{"myGroup1","myGroup2"}');
WARNING:  _check_fk_groups: Foreign key "mytbl6_col61_fkey", from table "myschema2.mytbl6", references "myschema2.mytbl7" that is outside groups (myGroup1,myGroup2).
WARNING:  _check_fk_groups: table "myschema2.mytbl6" is referenced by foreign key "mytbl8_col81_fkey" from table "myschema2.mytbl8" that is outside groups (myGroup1,myGroup2).
 emaj_alter_groups 
-------------------
                15
(1 row)

select nspname from pg_namespace, pg_class where relnamespace = pg_namespace.oid and relname = 'myschema2_myTbl3_log';
 nspname 
---------
 emajC
(1 row)

select count(*) from "emajC"."myschema1_myTbl3_log";
 count 
-------
     0
(1 row)

select spcname from pg_tablespace, pg_class where reltablespace = pg_tablespace.oid and relname = 'myschema1_mytbl2b_log';
  spcname  
-----------
 tsp log'2
(1 row)

select spcname from pg_tablespace, pg_class where reltablespace = pg_tablespace.oid and relname = 'myschema2_mytbl6_log_idx';
 spcname 
---------
(0 rows)

select mark_id, mark_group, regexp_replace(mark_name,E'\\d\\d\.\\d\\d\\.\\d\\d\\.\\d\\d\\d','%','g'), mark_time_id, mark_is_targetable, mark_is_rlbk_protected, mark_comment, mark_log_rows_before_next, mark_logged_rlbk_target_mark from emaj.emaj_mark where mark_id > 6000 order by mark_id;
 mark_id | mark_group |   regexp_replace   | mark_time_id | mark_is_targetable | mark_is_rlbk_protected | mark_comment | mark_log_rows_before_next | mark_logged_rlbk_target_mark 
---------+------------+--------------------+--------------+--------------------+------------------------+--------------+---------------------------+------------------------------
    6008 | myGroup1   | Init               |         6048 | t                  | f                      |              |                         0 | 
    6009 | myGroup2   | Init               |         6048 | t                  | f                      |              |                         0 | 
    6010 | myGroup1   | Priority Changed   |         6049 | t                  | f                      |              |                         0 | 
    6011 | myGroup1   | ALTER_%            |         6050 | t                  | f                      |              |                         0 | 
    6012 | myGroup2   | ALTER_%            |         6050 | t                  | f                      |              |                         0 | 
    6013 | myGroup1   | Attributes_changed |         6051 | t                  | f                      |              |                         0 | 
    6014 | myGroup2   | Attributes_changed |         6051 | t                  | f                      |              |                         0 | 
    6015 | myGroup1   | ALTER_%            |         6052 | t                  | f                      |              |                           | 
    6016 | myGroup2   | ALTER_%            |         6052 | t                  | f                      |              |                           | 
(9 rows)

-- execute rollbacks crossing alter group operations
select emaj.emaj_estimate_rollback_groups('{"myGroup1","myGroup2"}','Init',false);
 emaj_estimate_rollback_groups 
-------------------------------
 @ 0.015 secs
(1 row)

select * from emaj.emaj_logged_rollback_groups('{"myGroup1","myGroup2"}','Init',false);
ERROR:  _rlbk_check: This rollback operation would cross some previously exectuted alter group operations. You can remove this protection by using a less strict setting for this function.
CONTEXT:  PL/pgSQL function emaj._rlbk_check(text[],text,boolean,boolean) line 69 at RAISE
SQL statement "SELECT emaj._rlbk_check(v_groupNames, v_mark, v_isAlterGroupAllowed, FALSE)"
PL/pgSQL function emaj._rlbk_init(text[],text,boolean,integer,boolean,boolean) line 24 at SQL statement
SQL statement "SELECT emaj._rlbk_init(v_groupNames, v_mark, v_isLoggedRlbk, 1, v_multiGroup, v_isAlterGroupAllowed)"
PL/pgSQL function emaj._rlbk_groups(text[],text,boolean,boolean,boolean) line 20 at SQL statement
PL/pgSQL function emaj.emaj_logged_rollback_groups(text[],text,boolean) line 11 at RETURN QUERY
select * from emaj.emaj_rollback_groups('{"myGroup1","myGroup2"}','Init',true);
WARNING:  _check_fk_groups: Foreign key "mytbl6_col61_fkey", from table "myschema2.mytbl6", references "myschema2.mytbl7" that is outside groups (myGroup1,myGroup2).
WARNING:  _check_fk_groups: table "myschema2.mytbl6" is referenced by foreign key "mytbl8_col81_fkey" from table "myschema2.mytbl8" that is outside groups (myGroup1,myGroup2).
 rlbk_severity |                                rlbk_message                                 
---------------+-----------------------------------------------------------------------------
 Notice        | 0 tables and 4 sequences effectively processed.
 Warning       | Tables group change not rolled back: E-Maj priority for myschema1.mytbl1
 Warning       | Tables group change not rolled back: E-Maj priority for myschema1.mytbl1
 Warning       | Tables group change not rolled back: E-Maj attribute for myschema1.mytbl2b
 Warning       | Tables group change not rolled back: E-Maj attribute for myschema1."myTbl3"
 Warning       | Tables group change not rolled back: E-Maj attribute for myschema2."myTbl3"
 Warning       | Tables group change not rolled back: E-Maj attribute for myschema2.mytbl6
 Warning       | Tables group change not rolled back: E-Maj attribute for myschema1.mytbl2b
 Warning       | Tables group change not rolled back: E-Maj attribute for myschema1."myTbl3"
 Warning       | Tables group change not rolled back: E-Maj attribute for myschema2."myTbl3"
 Warning       | Tables group change not rolled back: E-Maj attribute for myschema2.mytbl6
(11 rows)

-----------------------------
-- test end: check and force sequences id
-----------------------------
select emaj.emaj_force_drop_group('myGroup1');
 emaj_force_drop_group 
-----------------------
                     7
(1 row)

select emaj.emaj_force_drop_group('myGroup2');
 emaj_force_drop_group 
-----------------------
                     8
(1 row)

select emaj.emaj_force_drop_group('myGroup4');
 emaj_force_drop_group 
-----------------------
                     5
(1 row)

select nspname from pg_namespace where nspname like 'emaj%' order by nspname;
 nspname 
---------
 emaj
(1 row)

select hist_function, hist_event, hist_object, 
       regexp_replace(regexp_replace(hist_wording,E'\\d\\d\.\\d\\d\\.\\d\\d\\.\\d\\d\\d','%','g'),E'\\[.+\\]','(timestamp)','g'), 
       hist_user 
  from emaj.emaj_hist where hist_id > 6000 order by hist_id;
   hist_function    |       hist_event        |         hist_object          |                          regexp_replace                          | hist_user 
--------------------+-------------------------+------------------------------+------------------------------------------------------------------+-----------
 LOCK_GROUP         | BEGIN                   | myGroup1                     |                                                                  | postgres
 LOCK_GROUP         | END                     | myGroup1                     | 5 tables locked, 0 deadlock(s)                                   | postgres
 SET_MARK_GROUP     | BEGIN                   | myGroup1                     | STOP_%                                                           | postgres
 SET_MARK_GROUP     | END                     | myGroup1                     | STOP_%                                                           | postgres
 STOP_GROUP         | END                     | myGroup1                     | 7 tables/sequences processed                                     | postgres
 RESET_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 RESET_GROUP        | END                     | myGroup1                     | 7 tables/sequences processed                                     | postgres
 DROP_GROUP         | BEGIN                   | myGroup1                     |                                                                  | postgres
 DROP_GROUP         | SCHEMA DROPPED          | emajb                        |                                                                  | postgres
 DROP_GROUP         | END                     | myGroup1                     | 7 tables/sequences processed                                     | postgres
 FORCE_DROP_GROUP   | BEGIN                   | myGroup2                     |                                                                  | postgres
 FORCE_DROP_GROUP   | SCHEMA DROPPED          | "emajC"                      |                                                                  | postgres
 FORCE_DROP_GROUP   | END                     | myGroup2                     | 8 tables/sequences processed                                     | postgres
 STOP_GROUP         | BEGIN                   | phil's group#3",             |                                                                  | postgres
 LOCK_GROUP         | BEGIN                   | phil's group#3",             |                                                                  | postgres
 LOCK_GROUP         | END                     | phil's group#3",             | 2 tables locked, 0 deadlock(s)                                   | postgres
 SET_MARK_GROUP     | BEGIN                   | phil's group#3",             | Simple stop mark                                                 | postgres
 SET_MARK_GROUP     | END                     | phil's group#3",             | Simple stop mark                                                 | postgres
 STOP_GROUP         | END                     | phil's group#3",             | 4 tables/sequences processed                                     | postgres
 DROP_GROUP         | BEGIN                   | phil's group#3",             |                                                                  | postgres
 DROP_GROUP         | SCHEMA DROPPED          | "emaj #'3"                   |                                                                  | postgres
 DROP_GROUP         | END                     | phil's group#3",             | 4 tables/sequences processed                                     | postgres
 FORCE_STOP_GROUP   | BEGIN                   | myGroup4                     |                                                                  | postgres
 LOCK_GROUP         | BEGIN                   | myGroup4                     |                                                                  | postgres
 LOCK_GROUP         | END                     | myGroup4                     | 5 tables locked, 0 deadlock(s)                                   | postgres
 FORCE_STOP_GROUP   | END                     | myGroup4                     | 5 tables/sequences processed                                     | postgres
 DROP_GROUP         | BEGIN                   | myGroup4                     |                                                                  | postgres
 DROP_GROUP         | END                     | myGroup4                     | 5 tables/sequences processed                                     | postgres
 FORCE_STOP_GROUP   | BEGIN                   | emptyGroup                   |                                                                  | postgres
 LOCK_GROUP         | BEGIN                   | emptyGroup                   |                                                                  | postgres
 LOCK_GROUP         | END                     | emptyGroup                   | 0 tables locked, 0 deadlock(s)                                   | postgres
 FORCE_STOP_GROUP   | END                     | emptyGroup                   | 0 tables/sequences processed                                     | postgres
 DROP_GROUP         | BEGIN                   | emptyGroup                   |                                                                  | postgres
 DROP_GROUP         | END                     | emptyGroup                   | 0 tables/sequences processed                                     | postgres
 CREATE_GROUP       | BEGIN                   | myGroup1                     | rollbackable                                                     | postgres
 CREATE_GROUP       | SCHEMA CREATED          | emajb                        |                                                                  | postgres
 CREATE_GROUP       | SCHEMA CREATED          | "emajC"                      |                                                                  | postgres
 CREATE_GROUP       | END                     | myGroup1                     | 7 tables/sequences processed                                     | postgres
 CREATE_GROUP       | BEGIN                   | myGroup2                     | rollbackable                                                     | postgres
 CREATE_GROUP       | END                     | myGroup2                     | 8 tables/sequences processed                                     | postgres
 CREATE_GROUP       | BEGIN                   | emptyGroup                   | rollbackable                                                     | postgres
 CREATE_GROUP       | END                     | emptyGroup                   | 0 tables/sequences processed                                     | postgres
 CREATE_GROUP       | BEGIN                   | myGroup4                     | rollbackable                                                     | postgres
 CREATE_GROUP       | END                     | myGroup4                     | 5 tables/sequences processed                                     | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6008                                              | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 ALTER_GROUP        | SCHEMA DROPPED          | emajb                        |                                                                  | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6009                                              | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6010                                              | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 ALTER_GROUP        | SCHEMA CREATED          | emajb                        |                                                                  | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6011                                              | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6012                                              | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema1."myTbl3"           | Applied changes: log schema                                      | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6013                                              | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema1."myTbl3"           | Applied changes: log schema                                      | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6014                                              | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema1."myTbl3"           | Applied changes: emaj names prefix                               | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6015                                              | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema1."myTbl3"           | Applied changes: emaj names prefix                               | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6016                                              | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema1.mytbl2b            | Applied changes: log data tablespace                             | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6017                                              | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema1.mytbl2b            | Applied changes: log data tablespace                             | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6018                                              | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema1."myTbl3"           | Applied changes: log data tablespace                             | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema1.mytbl1             | Applied changes: log data tablespace                             | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema1.mytbl4             | Applied changes: log data tablespace                             | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema1.mytbl2             | Applied changes: log data tablespace                             | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema1.mytbl2b            | Applied changes: log data tablespace                             | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6019                                              | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema1."myTbl3"           | Applied changes: log data tablespace                             | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema1.mytbl1             | Applied changes: log data tablespace                             | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema1.mytbl4             | Applied changes: log data tablespace                             | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema1.mytbl2             | Applied changes: log data tablespace                             | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema1.mytbl2b            | Applied changes: log data tablespace                             | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6020                                              | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema1.mytbl2b            | Applied changes: log index tablespace                            | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6021                                              | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema1.mytbl2b            | Applied changes: log index tablespace                            | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6022                                              | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6023                                              | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6024                                              | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6025                                              | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6026                                              | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6027                                              | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6028                                              | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6029                                              | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6030                                              | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6031                                              | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6032                                              | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6033                                              | postgres
 DISABLE_PROTECTION | EVENT TRIGGERS DISABLED |                              | emaj_protection_trg, emaj_sql_drop_trg, emaj_table_rewrite_trg   | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6034                                              | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6035                                              | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6036                                              | postgres
 ENABLE_PROTECTION  | EVENT TRIGGERS ENABLED  |                              | emaj_protection_trg, emaj_sql_drop_trg, emaj_table_rewrite_trg   | postgres
 ALTER_GROUPS       | BEGIN                   | myGroup1,myGroup2            |                                                                  | postgres
 ALTER_GROUP        | SCHEMA DROPPED          | emajb                        |                                                                  | postgres
 ALTER_GROUPS       | END                     | myGroup1,myGroup2            | Timestamp Id : 6039                                              | postgres
 ALTER_GROUPS       | BEGIN                   | myGroup1,myGroup2            |                                                                  | postgres
 ALTER_GROUP        | SCHEMA CREATED          | emajb                        |                                                                  | postgres
 ALTER_GROUPS       | END                     | myGroup1,myGroup2            | Timestamp Id : 6040                                              | postgres
 ALTER_GROUPS       | BEGIN                   | myGroup1,myGroup2            |                                                                  | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema1."myTbl3"           | Applied changes: emaj names prefix                               | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema2."myTbl3"           | Applied changes: log schema                                      | postgres
 ALTER_GROUPS       | END                     | myGroup1,myGroup2            | Timestamp Id : 6041                                              | postgres
 ALTER_GROUPS       | BEGIN                   | myGroup1,myGroup2            |                                                                  | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema1."myTbl3"           | Applied changes: emaj names prefix                               | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema2."myTbl3"           | Applied changes: log schema                                      | postgres
 ALTER_GROUPS       | END                     | myGroup1,myGroup2            | Timestamp Id : 6042                                              | postgres
 ALTER_GROUPS       | BEGIN                   | myGroup1,myGroup2            |                                                                  | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema1.mytbl2b            | Applied changes: log data tablespace                             | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema2.mytbl6             | Applied changes: log index tablespace                            | postgres
 ALTER_GROUPS       | END                     | myGroup1,myGroup2            | Timestamp Id : 6043                                              | postgres
 ALTER_GROUPS       | BEGIN                   | myGroup1,myGroup2            |                                                                  | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema1.mytbl2b            | Applied changes: log data tablespace                             | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema2.mytbl6             | Applied changes: log index tablespace                            | postgres
 ALTER_GROUPS       | END                     | myGroup1,myGroup2            | Timestamp Id : 6044                                              | postgres
 ALTER_GROUPS       | BEGIN                   | myGroup1,myGroup2            |                                                                  | postgres
 ALTER_GROUPS       | END                     | myGroup1,myGroup2            | Timestamp Id : 6045                                              | postgres
 ALTER_GROUPS       | BEGIN                   | myGroup1,myGroup2            |                                                                  | postgres
 ALTER_GROUPS       | END                     | myGroup1,myGroup2            | Timestamp Id : 6046                                              | postgres
 START_GROUPS       | BEGIN                   | myGroup1,myGroup2            | With log reset                                                   | postgres
 LOCK_GROUPS        | BEGIN                   | myGroup1,myGroup2            |                                                                  | postgres
 LOCK_GROUPS        | END                     | myGroup1,myGroup2            | 11 tables locked, 0 deadlock(s)                                  | postgres
 SET_MARK_GROUPS    | BEGIN                   | myGroup1,myGroup2            | Init                                                             | postgres
 SET_MARK_GROUPS    | END                     | myGroup1,myGroup2            | Init                                                             | postgres
 START_GROUPS       | END                     | myGroup1,myGroup2            | 15 tables/sequences processed                                    | postgres
 ALTER_GROUP        | BEGIN                   | myGroup1                     |                                                                  | postgres
 LOCK_GROUP         | BEGIN                   | myGroup1                     |                                                                  | postgres
 LOCK_GROUP         | END                     | myGroup1                     | 5 tables locked, 0 deadlock(s)                                   | postgres
 SET_MARK_GROUP     | BEGIN                   | myGroup1                     | Priority Changed                                                 | postgres
 SET_MARK_GROUP     | END                     | myGroup1                     | Priority Changed                                                 | postgres
 ALTER_GROUP        | END                     | myGroup1                     | Timestamp Id : 6049                                              | postgres
 ALTER_GROUPS       | BEGIN                   | myGroup1,myGroup2            |                                                                  | postgres
 LOCK_GROUPS        | BEGIN                   | myGroup1,myGroup2            |                                                                  | postgres
 LOCK_GROUPS        | END                     | myGroup1,myGroup2            | 11 tables locked, 0 deadlock(s)                                  | postgres
 SET_MARK_GROUPS    | BEGIN                   | myGroup1,myGroup2            | ALTER_%                                                          | postgres
 SET_MARK_GROUPS    | END                     | myGroup1,myGroup2            | ALTER_%                                                          | postgres
 ALTER_GROUPS       | END                     | myGroup1,myGroup2            | Timestamp Id : 6050                                              | postgres
 ALTER_GROUPS       | BEGIN                   | myGroup1,myGroup2            |                                                                  | postgres
 LOCK_GROUPS        | BEGIN                   | myGroup1,myGroup2            |                                                                  | postgres
 LOCK_GROUPS        | END                     | myGroup1,myGroup2            | 11 tables locked, 0 deadlock(s)                                  | postgres
 SET_MARK_GROUPS    | BEGIN                   | myGroup1,myGroup2            | Attributes_changed                                               | postgres
 SET_MARK_GROUPS    | END                     | myGroup1,myGroup2            | Attributes_changed                                               | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema1."myTbl3"           | Applied changes: emaj names prefix                               | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema1.mytbl2b            | Applied changes: log data tablespace                             | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema2."myTbl3"           | Applied changes: log schema                                      | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema2.mytbl6             | Applied changes: log index tablespace                            | postgres
 ALTER_GROUPS       | END                     | myGroup1,myGroup2            | Timestamp Id : 6051                                              | postgres
 ALTER_GROUPS       | BEGIN                   | myGroup1,myGroup2            |                                                                  | postgres
 LOCK_GROUPS        | BEGIN                   | myGroup1,myGroup2            |                                                                  | postgres
 LOCK_GROUPS        | END                     | myGroup1,myGroup2            | 11 tables locked, 0 deadlock(s)                                  | postgres
 SET_MARK_GROUPS    | BEGIN                   | myGroup1,myGroup2            | ALTER_%                                                          | postgres
 SET_MARK_GROUPS    | END                     | myGroup1,myGroup2            | ALTER_%                                                          | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema1."myTbl3"           | Applied changes: emaj names prefix                               | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema1.mytbl2b            | Applied changes: log data tablespace                             | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema2."myTbl3"           | Applied changes: log schema                                      | postgres
 ALTER_GROUP        | TABLE ATTR CHANGED      | myschema2.mytbl6             | Applied changes: log index tablespace                            | postgres
 ALTER_GROUPS       | END                     | myGroup1,myGroup2            | Timestamp Id : 6052                                              | postgres
 ROLLBACK_GROUPS    | BEGIN                   | myGroup1,myGroup2            | Unlogged rollback to mark Init (timestamp)                       | postgres
 DBLINK_OPEN_CNX    |                         | rlbk#1                       | Status = 1                                                       | postgres
 LOCK_GROUP         | BEGIN                   | myGroup1,myGroup2            | Rollback session #1                                              | postgres
 LOCK_GROUP         | END                     | myGroup1,myGroup2            | Rollback session #1: 11 tables locked, 0 deadlock(s)             | postgres
 ROLLBACK_GROUPS    | MARK DELETED            | myGroup1                     | mark Priority Changed is deleted                                 | postgres
 ROLLBACK_GROUPS    | MARK DELETED            | myGroup1                     | mark ALTER_% is deleted                                          | postgres
 ROLLBACK_GROUPS    | MARK DELETED            | myGroup2                     | mark ALTER_% is deleted                                          | postgres
 ROLLBACK_GROUPS    | MARK DELETED            | myGroup1                     | mark Attributes_changed is deleted                               | postgres
 ROLLBACK_GROUPS    | MARK DELETED            | myGroup2                     | mark Attributes_changed is deleted                               | postgres
 ROLLBACK_GROUPS    | MARK DELETED            | myGroup1                     | mark ALTER_% is deleted                                          | postgres
 ROLLBACK_GROUPS    | MARK DELETED            | myGroup2                     | mark ALTER_% is deleted                                          | postgres
 ROLLBACK_SEQUENCE  |                         | myschema1."myTbl3_col31_seq" |                                                                  | postgres
 ROLLBACK_SEQUENCE  |                         | myschema1.mytbl2b_col20_seq  |                                                                  | postgres
 ROLLBACK_SEQUENCE  |                         | myschema2.myseq1             |                                                                  | postgres
 ROLLBACK_SEQUENCE  |                         | myschema2."myTbl3_col31_seq" |                                                                  | postgres
 ROLLBACK_GROUPS    | END                     | myGroup1,myGroup2            | Rollback_id 6000, 0 tables and 4 sequences effectively processed | postgres
 DBLINK_CLOSE_CNX   |                         | rlbk#1                       |                                                                  | postgres
 FORCE_DROP_GROUP   | BEGIN                   | myGroup1                     |                                                                  | postgres
 FORCE_DROP_GROUP   | SCHEMA DROPPED          | emajb                        |                                                                  | postgres
 FORCE_DROP_GROUP   | END                     | myGroup1                     | 7 tables/sequences processed                                     | postgres
 FORCE_DROP_GROUP   | BEGIN                   | myGroup2                     |                                                                  | postgres
 FORCE_DROP_GROUP   | SCHEMA DROPPED          | "emajC"                      |                                                                  | postgres
 FORCE_DROP_GROUP   | END                     | myGroup2                     | 8 tables/sequences processed                                     | postgres
 FORCE_DROP_GROUP   | BEGIN                   | myGroup4                     |                                                                  | postgres
 FORCE_DROP_GROUP   | END                     | myGroup4                     | 5 tables/sequences processed                                     | postgres
(213 rows)

select time_id, time_last_emaj_gid, time_event from emaj.emaj_time_stamp where time_id > 6000 order by time_id;
 time_id | time_last_emaj_gid | time_event 
---------+--------------------+------------
    6001 |              11861 | M
    6002 |              11861 | C
    6003 |              11861 | C
    6004 |              11861 | C
    6005 |              11861 | C
    6008 |              11861 | A
    6009 |              11861 | A
    6010 |              11861 | A
    6011 |              11861 | A
    6012 |              11861 | A
    6013 |              11861 | A
    6014 |              11861 | A
    6015 |              11861 | A
    6016 |              11861 | A
    6017 |              11861 | A
    6018 |              11861 | A
    6019 |              11861 | A
    6020 |              11861 | A
    6021 |              11861 | A
    6022 |              11861 | A
    6023 |              11861 | A
    6024 |              11861 | A
    6025 |              11861 | A
    6026 |              11861 | A
    6027 |              11861 | A
    6028 |              11861 | A
    6029 |              11861 | A
    6030 |              11861 | A
    6031 |              11861 | A
    6032 |              11861 | A
    6033 |              11861 | A
    6034 |              11861 | A
    6035 |              11861 | A
    6036 |              11861 | A
    6039 |              11861 | A
    6040 |              11861 | A
    6041 |              11861 | A
    6042 |              11861 | A
    6043 |              11861 | A
    6044 |              11861 | A
    6045 |              11861 | A
    6046 |              11861 | A
    6048 |              11861 | M
    6049 |              11861 | A
    6050 |              11861 | A
    6051 |              11861 | A
    6052 |              11861 | A
    6053 |              11861 | R
(48 rows)

select * from emaj.emaj_alter_plan order by 1,2,3,4,5;
 altr_time_id |     altr_step     | altr_schema |   altr_tblseq    | altr_group | altr_priority | altr_group_is_logging | altr_new_group | altr_new_priority | altr_new_group_is_logging 
--------------+-------------------+-------------+------------------+------------+---------------+-----------------------+----------------+-------------------+---------------------------
         6008 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6009 | REMOVE_TBL        | myschema1   | mytbl2b          | myGroup1   |               | f                     |                |                   | 
         6009 | REMOVE_TBL        | myschema1   | myTbl3           | myGroup1   |            10 | f                     |                |                   | 
         6009 | REMOVE_TBL        | myschema1   | mytbl4           | myGroup1   |            20 | f                     |                |                   | 
         6009 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6009 | DROP_LOG_SCHEMA   | emajb       |                  |            |               |                       |                |                   | 
         6010 | REMOVE_SEQ        | myschema1   | myTbl3_col31_seq | myGroup1   |             1 | f                     |                |                   | 
         6010 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6011 | CREATE_LOG_SCHEMA | emajb       |                  |            |               |                       |                |                   | 
         6011 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6011 | ADD_TBL           | myschema1   | mytbl2b          | myGroup1   |               | f                     |                |                   | 
         6011 | ADD_TBL           | myschema1   | myTbl3           | myGroup1   |            10 | f                     |                |                   | 
         6011 | ADD_TBL           | myschema1   | mytbl4           | myGroup1   |            20 | f                     |                |                   | 
         6012 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6012 | ADD_SEQ           | myschema1   | myTbl3_col31_seq | myGroup1   |             1 | f                     |                |                   | 
         6013 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6013 | ATTRIBUTE_TBL     | myschema1   | myTbl3           | myGroup1   |            10 | f                     |                |                   | 
         6014 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6014 | ATTRIBUTE_TBL     | myschema1   | myTbl3           | myGroup1   |            10 | f                     |                |                   | 
         6015 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6015 | ATTRIBUTE_TBL     | myschema1   | myTbl3           | myGroup1   |            10 | f                     |                |                   | 
         6016 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6016 | ATTRIBUTE_TBL     | myschema1   | myTbl3           | myGroup1   |            10 | f                     |                |                   | 
         6017 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6017 | ATTRIBUTE_TBL     | myschema1   | mytbl2b          | myGroup1   |               | f                     |                |                   | 
         6018 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6018 | ATTRIBUTE_TBL     | myschema1   | mytbl2b          | myGroup1   |               | f                     |                |                   | 
         6019 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6019 | ATTRIBUTE_TBL     | myschema1   | mytbl1           | myGroup1   |            20 | f                     |                |                   | 
         6019 | ATTRIBUTE_TBL     | myschema1   | mytbl2           | myGroup1   |               | f                     |                |                   | 
         6019 | ATTRIBUTE_TBL     | myschema1   | mytbl2b          | myGroup1   |               | f                     |                |                   | 
         6019 | ATTRIBUTE_TBL     | myschema1   | myTbl3           | myGroup1   |            10 | f                     |                |                   | 
         6019 | ATTRIBUTE_TBL     | myschema1   | mytbl4           | myGroup1   |            20 | f                     |                |                   | 
         6020 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6020 | ATTRIBUTE_TBL     | myschema1   | mytbl1           | myGroup1   |            20 | f                     |                |                   | 
         6020 | ATTRIBUTE_TBL     | myschema1   | mytbl2           | myGroup1   |               | f                     |                |                   | 
         6020 | ATTRIBUTE_TBL     | myschema1   | mytbl2b          | myGroup1   |               | f                     |                |                   | 
         6020 | ATTRIBUTE_TBL     | myschema1   | myTbl3           | myGroup1   |            10 | f                     |                |                   | 
         6020 | ATTRIBUTE_TBL     | myschema1   | mytbl4           | myGroup1   |            20 | f                     |                |                   | 
         6021 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6021 | ATTRIBUTE_TBL     | myschema1   | mytbl2b          | myGroup1   |               | f                     |                |                   | 
         6022 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6022 | ATTRIBUTE_TBL     | myschema1   | mytbl2b          | myGroup1   |               | f                     |                |                   | 
         6023 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6023 | PRIORITY_REL      | myschema1   | mytbl1           | myGroup1   |            20 | f                     |                |                30 | 
         6024 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6024 | PRIORITY_REL      | myschema1   | mytbl1           | myGroup1   |            30 | f                     |                |                   | 
         6025 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6025 | PRIORITY_REL      | myschema1   | mytbl1           | myGroup1   |               | f                     |                |                20 | 
         6026 | REPAIR_TBL        | myschema1   | mytbl1           | myGroup1   |            20 | f                     |                |                   | 
         6026 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6027 | REPAIR_TBL        | myschema1   | mytbl1           | myGroup1   |            20 | f                     |                |                   | 
         6027 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6028 | REPAIR_TBL        | myschema1   | mytbl1           | myGroup1   |            20 | f                     |                |                   | 
         6028 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6029 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6030 | REPAIR_TBL        | myschema1   | mytbl1           | myGroup1   |            20 | f                     |                |                   | 
         6030 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6031 | REMOVE_TBL        | myschema1   | mytbl1           | myGroup1   |            20 | f                     |                |                   | 
         6031 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6031 | ADD_TBL           | myschema1   | mytbl1_new_name  | myGroup1   |            20 | f                     |                |                   | 
         6032 | REMOVE_TBL        | myschema1   | mytbl1_new_name  | myGroup1   |            20 | f                     |                |                   | 
         6032 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6032 | ADD_TBL           | public      | mytbl1_new_name  | myGroup1   |            20 | f                     |                |                   | 
         6033 | REMOVE_TBL        | public      | mytbl1_new_name  | myGroup1   |            20 | f                     |                |                   | 
         6033 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6033 | ADD_TBL           | myschema1   | mytbl1           | myGroup1   |            20 | f                     |                |                   | 
         6034 | REPAIR_TBL        | myschema1   | mytbl1           | myGroup1   |            20 | f                     |                |                   | 
         6034 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6035 | REPAIR_TBL        | myschema1   | mytbl1           | myGroup1   |            20 | f                     |                |                   | 
         6035 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6036 | REPAIR_TBL        | myschema1   | mytbl1           | myGroup1   |            20 | f                     |                |                   | 
         6036 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6039 | REMOVE_TBL        | myschema1   | mytbl2b          | myGroup1   |               | f                     |                |                   | 
         6039 | REMOVE_TBL        | myschema1   | myTbl3           | myGroup1   |            10 | f                     |                |                   | 
         6039 | REMOVE_TBL        | myschema2   | mytbl4           | myGroup2   |               | f                     |                |                   | 
         6039 | REMOVE_SEQ        | myschema1   | myTbl3_col31_seq | myGroup1   |             1 | f                     |                |                   | 
         6039 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6039 | RESET_GROUP       |             |                  | myGroup2   |               | f                     |                |                   | 
         6039 | DROP_LOG_SCHEMA   | emajb       |                  |            |               |                       |                |                   | 
         6040 | CREATE_LOG_SCHEMA | emajb       |                  |            |               |                       |                |                   | 
         6040 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6040 | RESET_GROUP       |             |                  | myGroup2   |               | f                     |                |                   | 
         6040 | ADD_TBL           | myschema1   | mytbl2b          | myGroup1   |               | f                     |                |                   | 
         6040 | ADD_TBL           | myschema1   | myTbl3           | myGroup1   |            10 | f                     |                |                   | 
         6040 | ADD_TBL           | myschema2   | mytbl4           | myGroup2   |               | f                     |                |                   | 
         6040 | ADD_SEQ           | myschema1   | myTbl3_col31_seq | myGroup1   |             1 | f                     |                |                   | 
         6041 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6041 | RESET_GROUP       |             |                  | myGroup2   |               | f                     |                |                   | 
         6041 | ATTRIBUTE_TBL     | myschema1   | myTbl3           | myGroup1   |            10 | f                     |                |                   | 
         6041 | ATTRIBUTE_TBL     | myschema2   | myTbl3           | myGroup2   |               | f                     |                |                   | 
         6042 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6042 | RESET_GROUP       |             |                  | myGroup2   |               | f                     |                |                   | 
         6042 | ATTRIBUTE_TBL     | myschema1   | myTbl3           | myGroup1   |            10 | f                     |                |                   | 
         6042 | ATTRIBUTE_TBL     | myschema2   | myTbl3           | myGroup2   |               | f                     |                |                   | 
         6043 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6043 | RESET_GROUP       |             |                  | myGroup2   |               | f                     |                |                   | 
         6043 | ATTRIBUTE_TBL     | myschema1   | mytbl2b          | myGroup1   |               | f                     |                |                   | 
         6043 | ATTRIBUTE_TBL     | myschema2   | mytbl6           | myGroup2   |               | f                     |                |                   | 
         6043 | PRIORITY_REL      | myschema1   | mytbl1           | myGroup1   |            20 | f                     |                |                30 | 
         6044 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6044 | RESET_GROUP       |             |                  | myGroup2   |               | f                     |                |                   | 
         6044 | ATTRIBUTE_TBL     | myschema1   | mytbl2b          | myGroup1   |               | f                     |                |                   | 
         6044 | ATTRIBUTE_TBL     | myschema2   | mytbl6           | myGroup2   |               | f                     |                |                   | 
         6044 | PRIORITY_REL      | myschema1   | mytbl1           | myGroup1   |            30 | f                     |                |                20 | 
         6045 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6045 | RESET_GROUP       |             |                  | myGroup2   |               | f                     |                |                   | 
         6045 | ASSIGN_REL        | myschema2   | myTbl3           | myGroup2   |               | f                     | myGroup1       |                   | f
         6045 | ASSIGN_REL        | myschema2   | myTbl3_col31_seq | myGroup2   |               | f                     | myGroup1       |                   | f
         6046 | RESET_GROUP       |             |                  | myGroup1   |               | f                     |                |                   | 
         6046 | RESET_GROUP       |             |                  | myGroup2   |               | f                     |                |                   | 
         6046 | ASSIGN_REL        | myschema2   | myTbl3           | myGroup1   |               | f                     | myGroup2       |                   | f
         6046 | ASSIGN_REL        | myschema2   | myTbl3_col31_seq | myGroup1   |               | f                     | myGroup2       |                   | f
         6049 | PRIORITY_REL      | myschema1   | mytbl1           | myGroup1   |            20 | t                     |                |                30 | 
         6050 | PRIORITY_REL      | myschema1   | mytbl1           | myGroup1   |            30 | t                     |                |                20 | 
         6051 | ATTRIBUTE_TBL     | myschema1   | mytbl2b          | myGroup1   |               | t                     |                |                   | 
         6051 | ATTRIBUTE_TBL     | myschema1   | myTbl3           | myGroup1   |            10 | t                     |                |                   | 
         6051 | ATTRIBUTE_TBL     | myschema2   | myTbl3           | myGroup2   |               | t                     |                |                   | 
         6051 | ATTRIBUTE_TBL     | myschema2   | mytbl6           | myGroup2   |               | t                     |                |                   | 
         6052 | ATTRIBUTE_TBL     | myschema1   | mytbl2b          | myGroup1   |               | t                     |                |                   | 
         6052 | ATTRIBUTE_TBL     | myschema1   | myTbl3           | myGroup1   |            10 | t                     |                |                   | 
         6052 | ATTRIBUTE_TBL     | myschema2   | myTbl3           | myGroup2   |               | t                     |                |                   | 
         6052 | ATTRIBUTE_TBL     | myschema2   | mytbl6           | myGroup2   |               | t                     |                |                   | 
(123 rows)

truncate emaj.emaj_hist;

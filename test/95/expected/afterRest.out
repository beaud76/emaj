-- afterRest.sql: Test emaj environment restored from a dump taken at the end of schedule reg tests
--                All operations are executed by super-user
--
-----------------------------
-- Checking restore
-----------------------------
select relname,relkind from pg_class where relname like 'emaj_%';
             relname             | relkind 
---------------------------------+---------
 emaj_consolidable_rollback_type | c
 emaj_detailed_log_stat_type     | c
 emaj_global_seq                 | S
 emaj_group                      | r
 emaj_group_def                  | r
 emaj_group_def_pkey             | i
 emaj_group_pkey                 | i
 emaj_hist                       | r
 emaj_hist_hist_id_seq           | S
 emaj_hist_pkey                  | i
 emaj_log_stat_type              | c
 emaj_mark                       | r
 emaj_mark_mark_id_seq           | S
 emaj_mark_pkey                  | i
 emaj_param                      | r
 emaj_param_pkey                 | i
 emaj_relation                   | r
 emaj_relation_idx1              | i
 emaj_relation_idx2              | i
 emaj_relation_pkey              | i
 emaj_rlbk                       | r
 emaj_rlbk_idx1                  | i
 emaj_rlbk_pkey                  | i
 emaj_rlbk_plan                  | r
 emaj_rlbk_plan_pkey             | i
 emaj_rlbk_rlbk_id_seq           | S
 emaj_rlbk_session               | r
 emaj_rlbk_session_pkey          | i
 emaj_rlbk_stat                  | r
 emaj_rlbk_stat_pkey             | i
 emaj_rollback_activity_type     | c
 emaj_seq_hole                   | r
 emaj_seq_hole_pkey              | i
 emaj_sequence                   | r
 emaj_sequence_pkey              | i
 emaj_time_stamp                 | r
 emaj_time_stamp_pkey            | i
 emaj_time_stamp_time_id_seq     | S
 emaj_visible_param              | v
(39 rows)

select * from emaj.emaj_global_seq;
  sequence_name  | last_value | start_value | increment_by |      max_value      | min_value | cache_value | log_cnt | is_cycled | is_called 
-----------------+------------+-------------+--------------+---------------------+-----------+-------------+---------+-----------+-----------
 emaj_global_seq |     100640 |           1 |            1 | 9223372036854775807 |         1 |           1 |       0 | f         | t
(1 row)

-----------------------------
-- Step 1 : for myGroup2, update tables and set a mark 
-----------------------------
set search_path=myschema2;
SET
insert into myTbl1 select 100+i, 'KLM', E'\\000\\014'::bytea from generate_series (1,11) as i;
INSERT 0 11
update myTbl1 set col13=E'\\000\\034'::bytea where col11 >105;
UPDATE 6
insert into myTbl2 values (100,'KLM','2012-12-31');
INSERT 0 1
delete from myTbl1 where col11 > 110;
DELETE 1
select nextval('myschema2.myseq1');
 nextval 
---------
    1004
(1 row)

--
select emaj.emaj_set_mark_group('myGroup2','After restore mark');
 emaj_set_mark_group 
---------------------
                   8
(1 row)

--
-----------------------------
-- Checking step 1
-----------------------------
-- emaj tables
select mark_id, mark_group, regexp_replace(mark_name,E'\\d\\d\.\\d\\d\\.\\d\\d\\.\\d\\d\\d','%','g'), mark_time_id, mark_is_deleted, mark_is_rlbk_protected, mark_comment, mark_log_rows_before_next, mark_logged_rlbk_target_mark from emaj.emaj_mark order by mark_id;
 mark_id | mark_group |        regexp_replace        | mark_time_id | mark_is_deleted | mark_is_rlbk_protected |     mark_comment     | mark_log_rows_before_next | mark_logged_rlbk_target_mark 
---------+------------+------------------------------+--------------+-----------------+------------------------+----------------------+---------------------------+------------------------------
     607 | myGroup2   | M3                           |          609 | t               | f                      | This mark is deleted |                         0 | 
     612 | myGroup1   | M4                           |          615 | t               | f                      |                      |                        10 | 
     613 | myGroup1   | M5                           |          616 | t               | f                      |                      |                         3 | 
     617 | myGroup1   | Before logged rollback to M4 |          622 | t               | f                      |                      |                        28 | 
     619 | myGroup1   | STOP_%                       |          624 | t               | f                      |                      |                         0 | 
     620 | myGroup2   | STOP_%                       |          624 | t               | f                      |                      |                         0 | 
     629 | myGroup1   | Stop after rollback          |          631 | t               | f                      |                      |                         0 | 
     630 | myGroup2   | Stop after rollback          |          631 | t               | f                      |                      |                         0 | 
     631 | myGroup1   | Multi-1                      |          632 | f               | f                      |                      |                           | 
     632 | myGroup2   | Multi-1                      |          632 | f               | f                      |                      |                        80 | 
    1001 | myGroup2   | RLBK_Multi-1_%_START         |         1000 | f               | f                      |                      |                        32 | 
    1003 | myGroup2   | RLBK_Multi-1_%_DONE          |         1001 | f               | f                      |                      |                        19 | Multi-1
    1004 | myGroup2   | After restore mark           |         1003 | f               | f                      |                      |                           | 
(13 rows)

select sequ_schema, sequ_name, sequ_time_id, sequ_last_val, sequ_is_called from emaj.emaj_sequence order by sequ_time_id, sequ_schema, sequ_name;
 sequ_schema |         sequ_name          | sequ_time_id | sequ_last_val | sequ_is_called 
-------------+----------------------------+--------------+---------------+----------------
 emaj        | myschema2_mytbl1_log_seq   |          609 |            15 | t
 emaj        | myschema2_mytbl2_log_seq   |          609 |             2 | t
 emaj        | myschema2_mytbl4_log_seq   |          609 |             4 | t
 emaj        | myschema2_mytbl6_log_seq   |          609 |            14 | t
 emaj        | otherPrefix4mytbl5_log_seq |          609 |             4 | t
 emajC       | myschema2_myTbl3_log_seq   |          609 |            10 | t
 myschema2   | myseq1                     |          609 |          1003 | t
 myschema2   | myTbl3_col31_seq           |          609 |            20 | t
 emaj        | myschema1_mytbl1_log_seq   |          615 |            30 | t
 emaj        | myschema1_mytbl2_log_seq   |          615 |             3 | t
 emaj        | myschema1_mytbl4_log_seq   |          615 |             8 | t
 emajb       | myschema1_mytbl2b_log_seq  |          615 |             1 | f
 emajC       | myschema1_myTbl3_log_seq   |          615 |            10 | t
 myschema1   | myTbl3_col31_seq           |          615 |            20 | t
 emaj        | myschema1_mytbl1_log_seq   |          616 |            30 | t
 emaj        | myschema1_mytbl2_log_seq   |          616 |             3 | t
 emaj        | myschema1_mytbl4_log_seq   |          616 |             8 | t
 emajb       | myschema1_mytbl2b_log_seq  |          616 |             1 | f
 emajC       | myschema1_myTbl3_log_seq   |          616 |            20 | t
 myschema1   | myTbl3_col31_seq           |          616 |            20 | t
 emaj        | myschema1_mytbl1_log_seq   |          622 |            32 | t
 emaj        | myschema1_mytbl2_log_seq   |          622 |             3 | t
 emaj        | myschema1_mytbl4_log_seq   |          622 |            12 | t
 emajb       | myschema1_mytbl2b_log_seq  |          622 |             1 | f
 emajC       | myschema1_myTbl3_log_seq   |          622 |            20 | t
 myschema1   | myTbl3_col31_seq           |          622 |            20 | t
 emaj        | myschema1_mytbl1_log_seq   |          624 |            33 | t
 emaj        | myschema1_mytbl2_log_seq   |          624 |             3 | t
 emaj        | myschema1_mytbl4_log_seq   |          624 |            14 | t
 emaj        | myschema2_mytbl1_log_seq   |          624 |            15 | t
 emaj        | myschema2_mytbl2_log_seq   |          624 |             2 | t
 emaj        | myschema2_mytbl4_log_seq   |          624 |            10 | t
 emaj        | myschema2_mytbl6_log_seq   |          624 |            23 | t
 emaj        | otherPrefix4mytbl5_log_seq |          624 |             7 | t
 emajb       | myschema1_mytbl2b_log_seq  |          624 |             1 | f
 emajC       | myschema1_myTbl3_log_seq   |          624 |            45 | t
 emajC       | myschema2_myTbl3_log_seq   |          624 |            10 | t
 myschema1   | myTbl3_col31_seq           |          624 |            20 | t
 myschema2   | myseq1                     |          624 |          1004 | f
 myschema2   | myTbl3_col31_seq           |          624 |            20 | t
 emaj        | myschema1_mytbl1_log_seq   |          631 |            33 | t
 emaj        | myschema1_mytbl2_log_seq   |          631 |             3 | t
 emaj        | myschema1_mytbl4_log_seq   |          631 |            14 | t
 emaj        | myschema2_mytbl1_log_seq   |          631 |            15 | t
 emaj        | myschema2_mytbl2_log_seq   |          631 |             2 | t
 emaj        | myschema2_mytbl4_log_seq   |          631 |            10 | t
 emaj        | myschema2_mytbl6_log_seq   |          631 |            23 | t
 emaj        | otherPrefix4mytbl5_log_seq |          631 |             7 | t
 emajb       | myschema1_mytbl2b_log_seq  |          631 |             1 | f
 emajC       | myschema1_myTbl3_log_seq   |          631 |            45 | t
 emajC       | myschema2_myTbl3_log_seq   |          631 |            10 | t
 myschema1   | myTbl3_col31_seq           |          631 |            20 | t
 myschema2   | myseq1                     |          631 |          1004 | f
 myschema2   | myTbl3_col31_seq           |          631 |            20 | t
 emaj        | myschema1_mytbl1_log_seq   |          632 |            33 | t
 emaj        | myschema1_mytbl2_log_seq   |          632 |             3 | t
 emaj        | myschema1_mytbl4_log_seq   |          632 |            14 | t
 emaj        | myschema2_mytbl1_log_seq   |          632 |            15 | t
 emaj        | myschema2_mytbl2_log_seq   |          632 |             2 | t
 emaj        | myschema2_mytbl4_log_seq   |          632 |            10 | t
 emaj        | myschema2_mytbl6_log_seq   |          632 |            23 | t
 emaj        | otherPrefix4mytbl5_log_seq |          632 |             7 | t
 emajb       | myschema1_mytbl2b_log_seq  |          632 |             1 | f
 emajC       | myschema1_myTbl3_log_seq   |          632 |            45 | t
 emajC       | myschema2_myTbl3_log_seq   |          632 |            10 | t
 myschema1   | myTbl3_col31_seq           |          632 |            20 | t
 myschema2   | myseq1                     |          632 |          1004 | f
 myschema2   | myTbl3_col31_seq           |          632 |            20 | t
 emaj        | myschema2_mytbl1_log_seq   |         1000 |            25 | t
 emaj        | myschema2_mytbl2_log_seq   |         1000 |             4 | t
 emaj        | myschema2_mytbl4_log_seq   |         1000 |            12 | t
 emaj        | myschema2_mytbl6_log_seq   |         1000 |            70 | t
 emaj        | otherPrefix4mytbl5_log_seq |         1000 |            16 | t
 emajC       | myschema2_myTbl3_log_seq   |         1000 |            20 | t
 myschema2   | myseq1                     |         1000 |          9999 | f
 myschema2   | myTbl3_col31_seq           |         1000 |            21 | f
 emaj        | myschema2_mytbl1_log_seq   |         1001 |            35 | t
 emaj        | myschema2_mytbl2_log_seq   |         1001 |             6 | t
 emaj        | myschema2_mytbl4_log_seq   |         1001 |            14 | t
 emaj        | myschema2_mytbl6_log_seq   |         1001 |            77 | t
 emaj        | otherPrefix4mytbl5_log_seq |         1001 |            17 | t
 emajC       | myschema2_myTbl3_log_seq   |         1001 |            30 | t
 myschema2   | myseq1                     |         1001 |          1004 | f
 myschema2   | myTbl3_col31_seq           |         1001 |            21 | f
 emaj        | myschema2_mytbl1_log_seq   |         1003 |            53 | t
 emaj        | myschema2_mytbl2_log_seq   |         1003 |             7 | t
 emaj        | myschema2_mytbl4_log_seq   |         1003 |            14 | t
 emaj        | myschema2_mytbl6_log_seq   |         1003 |            77 | t
 emaj        | otherPrefix4mytbl5_log_seq |         1003 |            17 | t
 emajC       | myschema2_myTbl3_log_seq   |         1003 |            30 | t
 myschema2   | myseq1                     |         1003 |          1004 | t
 myschema2   | myTbl3_col31_seq           |         1003 |            21 | f
(92 rows)

-- user tables
select * from mySchema2.myTbl1 order by col11,col12;
 col11 |   col12    | col13  
-------+------------+--------
     1 | ABC        | \x1c
     2 | ABC        | \x1c
     3 | ABC        | \x1c
     4 | ABC        | \x0c
     5 | ABC        | \x0c
     6 | ABC        | \x0c
     7 | ABC        | \x0c
     8 | ABC        | \x0c
     9 | ABC        | \x0c
    10 | ABC        | \x0c
   101 | KLM        | \x000c
   102 | KLM        | \x000c
   103 | KLM        | \x000c
   104 | KLM        | \x000c
   105 | KLM        | \x000c
   106 | KLM        | \x001c
   107 | KLM        | \x001c
   108 | KLM        | \x001c
   109 | KLM        | \x001c
   110 | KLM        | \x001c
(20 rows)

select * from mySchema2.myTbl2 order by col21;
 col21 | col22 |   col23    
-------+-------+------------
     1 | ABC   | 2010-01-01
     2 | DEF   | 
   100 | KLM   | 2012-12-31
(3 rows)

select col31,col33 from mySchema2."myTbl3" order by col31;
 col31 | col33 
-------+-------
    11 | 10.00
    12 | 10.00
    13 | 10.00
    14 | 10.00
    15 | 10.00
    16 | 10.00
    17 | 10.00
    18 | 10.00
    19 | 10.00
    20 | 10.00
(10 rows)

select * from mySchema2.myTbl4 order by col41;
 col41 | col42 | col43 | col44 |   col45    
-------+-------+-------+-------+------------
     1 | FK... |     2 |     1 | ABC       
     2 | FK... |     2 |     1 | ABC       
(2 rows)

-- log tables
select col11, col12, col13, emaj_verb, emaj_tuple, emaj_gid from emaj.mySchema2_myTbl1_log order by emaj_gid, emaj_tuple desc;
 col11 |   col12    | col13  | emaj_verb | emaj_tuple | emaj_gid 
-------+------------+--------+-----------+------------+----------
     4 | ABC        | \x0c   | DEL       | OLD        |   100543
     5 | ABC        | \x0c   | DEL       | OLD        |   100544
     6 | ABC        | \x0c   | DEL       | OLD        |   100545
     7 | ABC        | \x0c   | DEL       | OLD        |   100546
     8 | ABC        | \x0c   | DEL       | OLD        |   100547
     9 | ABC        | \x0c   | DEL       | OLD        |   100548
    10 | ABC        | \x0c   | DEL       | OLD        |   100549
     1 | ABC        | \x1c   | DEL       | OLD        |   100550
     2 | ABC        | \x1c   | DEL       | OLD        |   100551
     3 | ABC        | \x1c   | DEL       | OLD        |   100552
    10 | ABC        | \x0c   | INS       | NEW        |   100598
     3 | ABC        | \x1c   | INS       | NEW        |   100599
     4 | ABC        | \x0c   | INS       | NEW        |   100600
     1 | ABC        | \x1c   | INS       | NEW        |   100601
     5 | ABC        | \x0c   | INS       | NEW        |   100602
     7 | ABC        | \x0c   | INS       | NEW        |   100603
     8 | ABC        | \x0c   | INS       | NEW        |   100604
     6 | ABC        | \x0c   | INS       | NEW        |   100605
     9 | ABC        | \x0c   | INS       | NEW        |   100606
     2 | ABC        | \x1c   | INS       | NEW        |   100607
   101 | KLM        | \x000c | INS       | NEW        |   100641
   102 | KLM        | \x000c | INS       | NEW        |   100642
   103 | KLM        | \x000c | INS       | NEW        |   100643
   104 | KLM        | \x000c | INS       | NEW        |   100644
   105 | KLM        | \x000c | INS       | NEW        |   100645
   106 | KLM        | \x000c | INS       | NEW        |   100646
   107 | KLM        | \x000c | INS       | NEW        |   100647
   108 | KLM        | \x000c | INS       | NEW        |   100648
   109 | KLM        | \x000c | INS       | NEW        |   100649
   110 | KLM        | \x000c | INS       | NEW        |   100650
   111 | KLM        | \x000c | INS       | NEW        |   100651
   106 | KLM        | \x000c | UPD       | OLD        |   100652
   106 | KLM        | \x001c | UPD       | NEW        |   100652
   107 | KLM        | \x000c | UPD       | OLD        |   100653
   107 | KLM        | \x001c | UPD       | NEW        |   100653
   108 | KLM        | \x000c | UPD       | OLD        |   100654
   108 | KLM        | \x001c | UPD       | NEW        |   100654
   109 | KLM        | \x000c | UPD       | OLD        |   100655
   109 | KLM        | \x001c | UPD       | NEW        |   100655
   110 | KLM        | \x000c | UPD       | OLD        |   100656
   110 | KLM        | \x001c | UPD       | NEW        |   100656
   111 | KLM        | \x000c | UPD       | OLD        |   100657
   111 | KLM        | \x001c | UPD       | NEW        |   100657
   111 | KLM        | \x001c | DEL       | OLD        |   100659
(44 rows)

select col21, col22, col23, emaj_verb, emaj_tuple, emaj_gid from emaj.mySchema2_myTbl2_log order by emaj_gid, emaj_tuple desc;
 col21 | col22 |   col23    | emaj_verb | emaj_tuple | emaj_gid 
-------+-------+------------+-----------+------------+----------
     1 | ABC   | 2010-01-01 | DEL       | OLD        |   100553
     2 | DEF   |            | DEL       | OLD        |   100554
     1 | ABC   | 2010-01-01 | INS       | NEW        |   100628
     2 | DEF   |            | INS       | NEW        |   100629
   100 | KLM   | 2012-12-31 | INS       | NEW        |   100658
(5 rows)

select col31, col33, emaj_verb, emaj_tuple, emaj_gid from "emajC"."myschema2_myTbl3_log" order by emaj_gid, emaj_tuple desc;
 col31 | col33 | emaj_verb | emaj_tuple | emaj_gid 
-------+-------+-----------+------------+----------
    11 | 10.00 | DEL       | OLD        |   100555
    12 | 10.00 | DEL       | OLD        |   100556
    13 | 10.00 | DEL       | OLD        |   100557
    14 | 10.00 | DEL       | OLD        |   100558
    15 | 10.00 | DEL       | OLD        |   100559
    16 | 10.00 | DEL       | OLD        |   100560
    17 | 10.00 | DEL       | OLD        |   100561
    18 | 10.00 | DEL       | OLD        |   100562
    19 | 10.00 | DEL       | OLD        |   100563
    20 | 10.00 | DEL       | OLD        |   100564
    14 | 10.00 | INS       | NEW        |   100582
    18 | 10.00 | INS       | NEW        |   100583
    20 | 10.00 | INS       | NEW        |   100585
    12 | 10.00 | INS       | NEW        |   100586
    13 | 10.00 | INS       | NEW        |   100588
    17 | 10.00 | INS       | NEW        |   100589
    19 | 10.00 | INS       | NEW        |   100591
    15 | 10.00 | INS       | NEW        |   100593
    16 | 10.00 | INS       | NEW        |   100595
    11 | 10.00 | INS       | NEW        |   100597
(20 rows)

select col41, col42, col43, col44, col45, emaj_verb, emaj_tuple, emaj_gid from emaj.mySchema2_myTbl4_log order by emaj_gid, emaj_tuple desc;
 col41 | col42 | col43 | col44 |   col45    | emaj_verb | emaj_tuple | emaj_gid 
-------+-------+-------+-------+------------+-----------+------------+----------
     1 | FK... |     2 |     1 | ABC        | DEL       | OLD        |   100541
     2 | FK... |     2 |     1 | ABC        | DEL       | OLD        |   100542
     1 | FK... |     2 |     1 | ABC        | INS       | NEW        |   100630
     2 | FK... |     2 |     1 | ABC        | INS       | NEW        |   100632
(4 rows)

--
-----------------------------
-- Step 2 : for myGroup2, rollback to mark Multi-1 (set before dump/restore) 
-----------------------------
select * from emaj.emaj_log_stat_group('myGroup2','Multi-1',NULL);
 stat_group | stat_schema | stat_table | stat_rows 
------------+-------------+------------+-----------
 myGroup2   | myschema2   | mytbl1     |        38
 myGroup2   | myschema2   | mytbl2     |         5
 myGroup2   | myschema2   | myTbl3     |        20
 myGroup2   | myschema2   | mytbl4     |         4
 myGroup2   | myschema2   | mytbl5     |        10
 myGroup2   | myschema2   | mytbl6     |        54
(6 rows)

select emaj.emaj_rollback_group('myGroup2','Multi-1');
WARNING:  _check_fk_groups: Foreign key "mytbl6_col61_fkey", from table "myschema2.mytbl6", references "myschema2.mytbl7" that is outside groups (myGroup2).
CONTEXT:  SQL statement "SELECT emaj._check_fk_groups(v_groupNames)"
PL/pgSQL function emaj._rlbk_init(text[],text,boolean,integer,boolean) line 68 at PERFORM
SQL statement "SELECT emaj._rlbk_init(v_groupNames, v_mark, v_isLoggedRlbk, 1, v_multiGroup)"
PL/pgSQL function emaj._rlbk_groups(text[],text,boolean,boolean) line 20 at SQL statement
PL/pgSQL function emaj.emaj_rollback_group(text,text) line 7 at RETURN
WARNING:  _check_fk_groups: table "myschema2.mytbl6" is referenced by foreign key "mytbl8_col81_fkey" from table "myschema2.mytbl8" that is outside groups (myGroup2).
CONTEXT:  SQL statement "SELECT emaj._check_fk_groups(v_groupNames)"
PL/pgSQL function emaj._rlbk_init(text[],text,boolean,integer,boolean) line 68 at PERFORM
SQL statement "SELECT emaj._rlbk_init(v_groupNames, v_mark, v_isLoggedRlbk, 1, v_multiGroup)"
PL/pgSQL function emaj._rlbk_groups(text[],text,boolean,boolean) line 20 at SQL statement
PL/pgSQL function emaj.emaj_rollback_group(text,text) line 7 at RETURN
 emaj_rollback_group 
---------------------
                   8
(1 row)

--
-----------------------------
-- Checking step 2
-----------------------------
-- emaj tables
select mark_id, mark_group, regexp_replace(mark_name,E'\\d\\d\.\\d\\d\\.\\d\\d\\.\\d\\d\\d','%','g'), mark_time_id, mark_is_deleted, mark_is_rlbk_protected, mark_comment, mark_log_rows_before_next, mark_logged_rlbk_target_mark from emaj.emaj_mark order by mark_id;
 mark_id | mark_group |        regexp_replace        | mark_time_id | mark_is_deleted | mark_is_rlbk_protected |     mark_comment     | mark_log_rows_before_next | mark_logged_rlbk_target_mark 
---------+------------+------------------------------+--------------+-----------------+------------------------+----------------------+---------------------------+------------------------------
     607 | myGroup2   | M3                           |          609 | t               | f                      | This mark is deleted |                         0 | 
     612 | myGroup1   | M4                           |          615 | t               | f                      |                      |                        10 | 
     613 | myGroup1   | M5                           |          616 | t               | f                      |                      |                         3 | 
     617 | myGroup1   | Before logged rollback to M4 |          622 | t               | f                      |                      |                        28 | 
     619 | myGroup1   | STOP_%                       |          624 | t               | f                      |                      |                         0 | 
     620 | myGroup2   | STOP_%                       |          624 | t               | f                      |                      |                         0 | 
     629 | myGroup1   | Stop after rollback          |          631 | t               | f                      |                      |                         0 | 
     630 | myGroup2   | Stop after rollback          |          631 | t               | f                      |                      |                         0 | 
     631 | myGroup1   | Multi-1                      |          632 | f               | f                      |                      |                           | 
     632 | myGroup2   | Multi-1                      |          632 | f               | f                      |                      |                           | 
(10 rows)

select sequ_schema, sequ_name, sequ_time_id, sequ_last_val, sequ_is_called from emaj.emaj_sequence order by sequ_time_id, sequ_schema, sequ_name;
 sequ_schema |         sequ_name          | sequ_time_id | sequ_last_val | sequ_is_called 
-------------+----------------------------+--------------+---------------+----------------
 emaj        | myschema2_mytbl1_log_seq   |          609 |            15 | t
 emaj        | myschema2_mytbl2_log_seq   |          609 |             2 | t
 emaj        | myschema2_mytbl4_log_seq   |          609 |             4 | t
 emaj        | myschema2_mytbl6_log_seq   |          609 |            14 | t
 emaj        | otherPrefix4mytbl5_log_seq |          609 |             4 | t
 emajC       | myschema2_myTbl3_log_seq   |          609 |            10 | t
 myschema2   | myseq1                     |          609 |          1003 | t
 myschema2   | myTbl3_col31_seq           |          609 |            20 | t
 emaj        | myschema1_mytbl1_log_seq   |          615 |            30 | t
 emaj        | myschema1_mytbl2_log_seq   |          615 |             3 | t
 emaj        | myschema1_mytbl4_log_seq   |          615 |             8 | t
 emajb       | myschema1_mytbl2b_log_seq  |          615 |             1 | f
 emajC       | myschema1_myTbl3_log_seq   |          615 |            10 | t
 myschema1   | myTbl3_col31_seq           |          615 |            20 | t
 emaj        | myschema1_mytbl1_log_seq   |          616 |            30 | t
 emaj        | myschema1_mytbl2_log_seq   |          616 |             3 | t
 emaj        | myschema1_mytbl4_log_seq   |          616 |             8 | t
 emajb       | myschema1_mytbl2b_log_seq  |          616 |             1 | f
 emajC       | myschema1_myTbl3_log_seq   |          616 |            20 | t
 myschema1   | myTbl3_col31_seq           |          616 |            20 | t
 emaj        | myschema1_mytbl1_log_seq   |          622 |            32 | t
 emaj        | myschema1_mytbl2_log_seq   |          622 |             3 | t
 emaj        | myschema1_mytbl4_log_seq   |          622 |            12 | t
 emajb       | myschema1_mytbl2b_log_seq  |          622 |             1 | f
 emajC       | myschema1_myTbl3_log_seq   |          622 |            20 | t
 myschema1   | myTbl3_col31_seq           |          622 |            20 | t
 emaj        | myschema1_mytbl1_log_seq   |          624 |            33 | t
 emaj        | myschema1_mytbl2_log_seq   |          624 |             3 | t
 emaj        | myschema1_mytbl4_log_seq   |          624 |            14 | t
 emaj        | myschema2_mytbl1_log_seq   |          624 |            15 | t
 emaj        | myschema2_mytbl2_log_seq   |          624 |             2 | t
 emaj        | myschema2_mytbl4_log_seq   |          624 |            10 | t
 emaj        | myschema2_mytbl6_log_seq   |          624 |            23 | t
 emaj        | otherPrefix4mytbl5_log_seq |          624 |             7 | t
 emajb       | myschema1_mytbl2b_log_seq  |          624 |             1 | f
 emajC       | myschema1_myTbl3_log_seq   |          624 |            45 | t
 emajC       | myschema2_myTbl3_log_seq   |          624 |            10 | t
 myschema1   | myTbl3_col31_seq           |          624 |            20 | t
 myschema2   | myseq1                     |          624 |          1004 | f
 myschema2   | myTbl3_col31_seq           |          624 |            20 | t
 emaj        | myschema1_mytbl1_log_seq   |          631 |            33 | t
 emaj        | myschema1_mytbl2_log_seq   |          631 |             3 | t
 emaj        | myschema1_mytbl4_log_seq   |          631 |            14 | t
 emaj        | myschema2_mytbl1_log_seq   |          631 |            15 | t
 emaj        | myschema2_mytbl2_log_seq   |          631 |             2 | t
 emaj        | myschema2_mytbl4_log_seq   |          631 |            10 | t
 emaj        | myschema2_mytbl6_log_seq   |          631 |            23 | t
 emaj        | otherPrefix4mytbl5_log_seq |          631 |             7 | t
 emajb       | myschema1_mytbl2b_log_seq  |          631 |             1 | f
 emajC       | myschema1_myTbl3_log_seq   |          631 |            45 | t
 emajC       | myschema2_myTbl3_log_seq   |          631 |            10 | t
 myschema1   | myTbl3_col31_seq           |          631 |            20 | t
 myschema2   | myseq1                     |          631 |          1004 | f
 myschema2   | myTbl3_col31_seq           |          631 |            20 | t
 emaj        | myschema1_mytbl1_log_seq   |          632 |            33 | t
 emaj        | myschema1_mytbl2_log_seq   |          632 |             3 | t
 emaj        | myschema1_mytbl4_log_seq   |          632 |            14 | t
 emaj        | myschema2_mytbl1_log_seq   |          632 |            15 | t
 emaj        | myschema2_mytbl2_log_seq   |          632 |             2 | t
 emaj        | myschema2_mytbl4_log_seq   |          632 |            10 | t
 emaj        | myschema2_mytbl6_log_seq   |          632 |            23 | t
 emaj        | otherPrefix4mytbl5_log_seq |          632 |             7 | t
 emajb       | myschema1_mytbl2b_log_seq  |          632 |             1 | f
 emajC       | myschema1_myTbl3_log_seq   |          632 |            45 | t
 emajC       | myschema2_myTbl3_log_seq   |          632 |            10 | t
 myschema1   | myTbl3_col31_seq           |          632 |            20 | t
 myschema2   | myseq1                     |          632 |          1004 | f
 myschema2   | myTbl3_col31_seq           |          632 |            20 | t
(68 rows)

select time_id, time_last_emaj_gid, time_event from emaj.emaj_time_stamp order by time_id;
 time_id | time_last_emaj_gid | time_event 
---------+--------------------+------------
      -4 |                    | 
      -3 |                    | 
      -2 |                    | 
      -1 |                    | 
      10 |                  0 | C
      11 |                  0 | C
      13 |                  0 | C
      14 |                  0 | C
      15 |                  0 | M
      16 |                  0 | M
      17 |                  0 | C
      18 |                  0 | M
      19 |                  0 | C
      20 |                  0 | C
      21 |                  0 | M
      22 |                  0 | M
      28 |                  0 | A
      29 |                  0 | A
      30 |                  0 | A
      31 |                  0 | A
      32 |                  0 | A
      33 |                  0 | A
      34 |                  0 | A
      35 |                  0 | A
      36 |                  0 | A
      37 |                  0 | A
      38 |                  0 | A
      39 |                  0 | A
      40 |                  0 | A
      41 |                  0 | A
      42 |                  0 | A
      43 |                  0 | A
      44 |                  0 | A
      45 |                  0 | A
      46 |                  0 | A
      47 |                  0 | A
      48 |                  0 | A
      49 |                  0 | A
      50 |                  0 | A
      51 |                  0 | A
      52 |                  0 | A
      53 |                  0 | A
      54 |                  0 | A
      55 |                  0 | A
      56 |                  0 | A
     200 |                  0 | C
     201 |                  0 | C
     202 |                  0 | M
     203 |                  0 | M
     204 |                  0 | M
     205 |                  0 | M
     206 |                  0 | M
     208 |                  0 | M
     209 |                  0 | M
     210 |                  2 | M
     211 |                  2 | M
     212 |                  2 | M
     213 |                  2 | M
     214 |                  2 | M
     215 |                  2 | M
     216 |                  2 | M
     217 |                  2 | M
     218 |                  2 | M
     219 |                  2 | M
     221 |                  2 | M
     222 |                  2 | M
     223 |                  2 | M
     224 |                  2 | M
     225 |                  2 | M
     226 |                  2 | M
     227 |                  2 | M
     300 |                  2 | M
     301 |                  2 | M
     302 |                  2 | M
     303 |                  2 | M
     304 |                  2 | M
     305 |                  2 | M
     306 |                  2 | M
     307 |                  2 | M
     308 |                  2 | M
     309 |                  2 | M
     310 |                  2 | M
     311 |                  2 | M
     312 |                  2 | M
     313 |                  2 | M
     314 |                  2 | M
     315 |                  2 | M
     316 |                  2 | M
     402 |                  2 | M
     403 |                  2 | M
     404 |                  2 | M
     405 |                  2 | M
     406 |                  2 | R
     414 |                  2 | R
     415 |                  2 | R
     416 |                  2 | R
     417 |                  2 | M
     418 |                  2 | R
     419 |                  2 | M
     420 |                  2 | M
     421 |                  2 | R
     422 |                  2 | R
     423 |                  2 | R
     424 |                  2 | M
     425 |                  2 | R
     426 |                  2 | M
     427 |                  2 | M
     428 |                  2 | M
     429 |                  2 | M
     430 |                 29 | M
     431 |                 41 | M
     432 |                 41 | R
     433 |                 41 | R
     434 |                 41 | M
     435 |                 41 | M
     436 |                 60 | M
     437 |                 71 | M
     438 |                 71 | R
     439 |                 82 | M
     440 |                 82 | R
     441 |                 96 | M
     442 |                 96 | R
     443 |                 96 | M
     444 |                 99 | M
     445 |                102 | R
     446 |                105 | M
     447 |                105 | R
     448 |                105 | M
     449 |                105 | R
     450 |                105 | M
     451 |                105 | M
     452 |                120 | M
     453 |                122 | R
     454 |                137 | M
     455 |                139 | R
     456 |                140 | R
     500 |                140 | M
     501 |                140 | M
     502 |                140 | M
     503 |              11740 | M
     504 |              11740 | M
     505 |              11850 | M
     506 |              11850 | M
     509 |              11861 | M
     510 |              11861 | M
     600 |              99999 | M
     601 |              99999 | M
     602 |              99999 | C
     603 |              99999 | C
     604 |              99999 | M
     605 |              99999 | M
     606 |             100026 | M
     607 |             100037 | M
     608 |             100078 | M
     609 |             100086 | M
     610 |             100086 | R
     611 |             100092 | M
     612 |             100092 | R
     613 |             100098 | M
     614 |             100098 | R
     615 |             100111 | M
     616 |             100121 | M
     617 |             100121 | M
     618 |             100121 | R
     619 |             100127 | M
     620 |             100127 | R
     621 |             100130 | R
     622 |             100133 | R
     623 |             100156 | M
     624 |             100161 | M
     625 |             100161 | M
     626 |             100161 | M
     627 |             100161 | R
     628 |             100161 | M
     629 |             100161 | R
     630 |             100161 | R
     631 |             100161 | M
     632 |             100161 | M
     633 |             100161 | M
     634 |             100161 | R
     635 |             100161 | C
     636 |             100161 | A
     637 |             100161 | M
     638 |             100161 | M
     639 |             100161 | A
     640 |             100161 | C
     641 |             100161 | M
     642 |             100213 | M
     643 |             100213 | M
     644 |             100216 | M
     645 |             100216 | R
     646 |             100216 | M
     647 |             100216 | R
     648 |             100236 | R
     649 |             100256 | R
     650 |             100256 | R
     651 |             100256 | R
     652 |             100331 | M
     653 |             100331 | A
     654 |             100331 | M
     655 |             100335 | M
     656 |             100337 | R
     657 |             100337 | M
     658 |             100337 | M
     659 |             100337 | M
     660 |             100353 | M
     661 |             100354 | R
     662 |             100366 | M
     663 |             100367 | M
     664 |             100379 | M
     665 |             100379 | M
     666 |             100379 | R
     667 |             100390 | M
     668 |             100390 | M
     669 |             100406 | M
     670 |             100407 | M
     671 |             100408 | R
     672 |             100409 | M
     673 |             100409 | M
     674 |             100421 | R
     675 |             100444 | M
     676 |             100444 | M
     677 |             100460 | R
     678 |             100466 | M
     679 |             100466 | M
     680 |             100468 | R
     681 |             100469 | M
     682 |             100469 | M
     683 |             100485 | M
     684 |             100486 | R
     685 |             100498 | M
     686 |             100498 | M
     687 |             100499 | R
     688 |             100512 | M
     689 |             100512 | R
    1000 |             100580 | R
    1001 |             100640 | M
    1002 |             100640 | R
    1003 |             100659 | M
    1004 |             100659 | R
(240 rows)

-- user tables
select * from mySchema2.myTbl1 order by col11,col12;
 col11 |   col12    | col13 
-------+------------+-------
     1 | ABC        | \x1c
     2 | ABC        | \x1c
     3 | ABC        | \x1c
     4 | ABC        | \x0c
     5 | ABC        | \x0c
     6 | ABC        | \x0c
     7 | ABC        | \x0c
     8 | ABC        | \x0c
     9 | ABC        | \x0c
    10 | ABC        | \x0c
(10 rows)

select * from mySchema2.myTbl2 order by col21;
 col21 | col22 |   col23    
-------+-------+------------
     1 | ABC   | 2010-01-01
     2 | DEF   | 
(2 rows)

select col31,col33 from mySchema2."myTbl3" order by col31;
 col31 | col33 
-------+-------
    11 | 10.00
    12 | 10.00
    13 | 10.00
    14 | 10.00
    15 | 10.00
    16 | 10.00
    17 | 10.00
    18 | 10.00
    19 | 10.00
    20 | 10.00
(10 rows)

select * from mySchema2.myTbl4 order by col41;
 col41 | col42 | col43 | col44 |   col45    
-------+-------+-------+-------+------------
     1 | FK... |     2 |     1 | ABC       
     2 | FK... |     2 |     1 | ABC       
(2 rows)

-- log tables
select col11, col12, col13, emaj_verb, emaj_tuple, emaj_gid from emaj.mySchema2_myTbl1_log order by emaj_gid, emaj_tuple desc;
 col11 | col12 | col13 | emaj_verb | emaj_tuple | emaj_gid 
-------+-------+-------+-----------+------------+----------
(0 rows)

select col21, col22, col23, emaj_verb, emaj_tuple, emaj_gid from emaj.mySchema2_myTbl2_log order by emaj_gid, emaj_tuple desc;
 col21 | col22 | col23 | emaj_verb | emaj_tuple | emaj_gid 
-------+-------+-------+-----------+------------+----------
(0 rows)

select col31, col33, emaj_verb, emaj_tuple, emaj_gid from "emajC"."myschema2_myTbl3_log" order by emaj_gid, emaj_tuple desc;
 col31 | col33 | emaj_verb | emaj_tuple | emaj_gid 
-------+-------+-----------+------------+----------
(0 rows)

select col41, col42, col43, col44, col45, emaj_verb, emaj_tuple, emaj_gid from emaj.mySchema2_myTbl4_log order by emaj_gid, emaj_tuple desc;
 col41 | col42 | col43 | col44 | col45 | emaj_verb | emaj_tuple | emaj_gid 
-------+-------+-------+-------+-------+-----------+------------+----------
(0 rows)

--
-----------------------------
-- Step 3 : stop myGroup2
-----------------------------
select emaj.emaj_stop_group('myGroup2');
 emaj_stop_group 
-----------------
               8
(1 row)

--
-----------------------------
-- test end: check and reset history
-----------------------------
select hist_id, hist_function, hist_event, hist_object, regexp_replace(regexp_replace(hist_wording,E'\\d\\d\.\\d\\d\\.\\d\\d\\.\\d\\d\\d','%','g'),E'\\[.+\\]','(timestamp)','g'), hist_user from 
  (select * from emaj.emaj_hist order by hist_id) as t;
 hist_id |   hist_function    |  hist_event  |         hist_object          |                         regexp_replace                          | hist_user 
---------+--------------------+--------------+------------------------------+-----------------------------------------------------------------+-----------
       1 | EMAJ_INSTALL       |              | E-Maj <NEXT_VERSION>         | Initialisation completed                                        | postgres
   10002 | ROLLBACK_GROUPS    | BEGIN        | myGroup1,myGroup2            | Logged rollback to mark Multi-1 (timestamp)                     | postgres
   10003 | DBLINK_OPEN_CNX    |              | rlbk#1                       | Status = 1                                                      | postgres
   10004 | LOCK_GROUP         | BEGIN        | myGroup1,myGroup2            | Rollback session #1                                             | postgres
   10005 | LOCK_GROUP         | END          | myGroup1,myGroup2            | Rollback session #1: 2 tables locked, 0 deadlock(s)             | postgres
   10006 | DBLINK_OPEN_CNX    |              | rlbk#2                       | Status = 1                                                      | postgres
   10007 | LOCK_GROUP         | BEGIN        | myGroup1,myGroup2            | Rollback session #2                                             | postgres
   10008 | LOCK_GROUP         | END          | myGroup1,myGroup2            | Rollback session #2: 5 tables locked, 0 deadlock(s)             | postgres
   10009 | DBLINK_OPEN_CNX    |              | rlbk#3                       | Status = 1                                                      | postgres
   10010 | LOCK_GROUP         | BEGIN        | myGroup1,myGroup2            | Rollback session #3                                             | postgres
   10011 | LOCK_GROUP         | END          | myGroup1,myGroup2            | Rollback session #3: 4 tables locked, 0 deadlock(s)             | postgres
   10012 | SET_MARK_GROUPS    | BEGIN        | myGroup1,myGroup2            | RLBK_Multi-1_%_START                                            | postgres
   10013 | SET_MARK_GROUPS    | END          | myGroup1,myGroup2            | RLBK_Multi-1_%_START                                            | postgres
   10014 | ROLLBACK_TABLE     | BEGIN        | myschema2."myTbl3"           | All log rows with emaj_gid > 100161 and <= 100580               | postgres
   10015 | ROLLBACK_TABLE     | BEGIN        | myschema2.mytbl6             | All log rows with emaj_gid > 100161 and <= 100580               | postgres
   10016 | ROLLBACK_TABLE     | END          | myschema2.mytbl6             | 14 rolled back primary keys                                     | postgres
   10017 | ROLLBACK_TABLE     | END          | myschema2."myTbl3"           | 10 rolled back primary keys                                     | postgres
   10018 | ROLLBACK_TABLE     | BEGIN        | myschema1.mytbl1             | All log rows with emaj_gid > 100161 and <= 100580               | postgres
   10019 | ROLLBACK_TABLE     | BEGIN        | myschema2.mytbl1             | All log rows with emaj_gid > 100161 and <= 100580               | postgres
   10020 | ROLLBACK_TABLE     | END          | myschema2.mytbl1             | 10 rolled back primary keys                                     | postgres
   10021 | ROLLBACK_TABLE     | BEGIN        | myschema2.mytbl2             | All log rows with emaj_gid > 100161 and <= 100580               | postgres
   10022 | ROLLBACK_TABLE     | END          | myschema1.mytbl1             | 20 rolled back primary keys                                     | postgres
   10023 | ROLLBACK_TABLE     | END          | myschema2.mytbl2             | 2 rolled back primary keys                                      | postgres
   10024 | ROLLBACK_TABLE     | BEGIN        | myschema1.mytbl2             | All log rows with emaj_gid > 100161 and <= 100580               | postgres
   10025 | ROLLBACK_TABLE     | BEGIN        | myschema2.mytbl4             | All log rows with emaj_gid > 100161 and <= 100580               | postgres
   10026 | ROLLBACK_TABLE     | END          | myschema2.mytbl4             | 2 rolled back primary keys                                      | postgres
   10027 | ROLLBACK_TABLE     | END          | myschema1.mytbl2             | 3 rolled back primary keys                                      | postgres
   10028 | ROLLBACK_TABLE     | BEGIN        | myschema1."myTbl3"           | All log rows with emaj_gid > 100161 and <= 100580               | postgres
   10029 | ROLLBACK_TABLE     | BEGIN        | myschema2.mytbl5             | All log rows with emaj_gid > 100161 and <= 100580               | postgres
   10030 | ROLLBACK_TABLE     | END          | myschema1."myTbl3"           | 5 rolled back primary keys                                      | postgres
   10031 | ROLLBACK_TABLE     | END          | myschema2.mytbl5             | 3 rolled back primary keys                                      | postgres
   10032 | DBLINK_CLOSE_CNX   |              | rlbk#2                       |                                                                 | postgres
   10033 | DBLINK_CLOSE_CNX   |              | rlbk#3                       |                                                                 | postgres
   10034 | ROLLBACK_SEQUENCE  |              | myschema1."myTbl3_col31_seq" | RESTART 21                                                      | postgres
   10035 | ROLLBACK_SEQUENCE  |              | myschema2.myseq1             | RESTART 1004                                                    | postgres
   10036 | ROLLBACK_SEQUENCE  |              | myschema2."myTbl3_col31_seq" | RESTART 21                                                      | postgres
   10037 | SET_MARK_GROUPS    | BEGIN        | myGroup1,myGroup2            | RLBK_Multi-1_%_DONE                                             | postgres
   10038 | SET_MARK_GROUPS    | END          | myGroup1,myGroup2            | RLBK_Multi-1_%_DONE                                             | postgres
   10039 | ROLLBACK_GROUPS    | END          | myGroup1,myGroup2            | Rollback_id 200, 9 tables and 3 sequences effectively processed | postgres
   10040 | DBLINK_CLOSE_CNX   |              | rlbk#1                       |                                                                 | postgres
   10041 | CLEANUP_RLBK_STATE |              | rollback id 200              | set to COMMITTED                                                | postgres
   10042 | ROLLBACK_GROUP     | BEGIN        | myGroup1                     | Unlogged rollback to mark Multi-1 (timestamp)                   | postgres
   10043 | DBLINK_OPEN_CNX    |              | rlbk#1                       | Status = 1                                                      | postgres
   10044 | LOCK_GROUP         | BEGIN        | myGroup1                     | Rollback session #1                                             | postgres
   10045 | LOCK_GROUP         | END          | myGroup1                     | Rollback session #1: 5 tables locked, 0 deadlock(s)             | postgres
   10046 | ROLLBACK_TABLE     | BEGIN        | myschema1.mytbl1             | All log rows with emaj_gid > 100161 and <= 100640               | postgres
   10047 | ROLLBACK_TABLE     | END          | myschema1.mytbl1             | 20 rolled back primary keys                                     | postgres
   10048 | ROLLBACK_TABLE     | BEGIN        | myschema1.mytbl2             | All log rows with emaj_gid > 100161 and <= 100640               | postgres
   10049 | ROLLBACK_TABLE     | END          | myschema1.mytbl2             | 3 rolled back primary keys                                      | postgres
   10050 | ROLLBACK_TABLE     | BEGIN        | myschema1."myTbl3"           | All log rows with emaj_gid > 100161 and <= 100640               | postgres
   10051 | ROLLBACK_TABLE     | END          | myschema1."myTbl3"           | 5 rolled back primary keys                                      | postgres
   10052 | ROLLBACK_GROUP     | MARK DELETED | myGroup1                     | mark RLBK_Multi-1_%_START is deleted                            | postgres
   10053 | ROLLBACK_GROUP     | MARK DELETED | myGroup1                     | mark RLBK_Multi-1_%_DONE is deleted                             | postgres
   10054 | ROLLBACK_SEQUENCE  |              | myschema1."myTbl3_col31_seq" | RESTART 21                                                      | postgres
   10055 | ROLLBACK_GROUP     | END          | myGroup1                     | Rollback_id 201, 3 tables and 1 sequences effectively processed | postgres
   10056 | DBLINK_CLOSE_CNX   |              | rlbk#1                       |                                                                 | postgres
   10057 | CLEANUP_RLBK_STATE |              | rollback id 201              | set to COMMITTED                                                | postgres
   10058 | SET_MARK_GROUP     | BEGIN        | myGroup2                     |                                                                 | postgres
   10059 | LOCK_GROUP         | BEGIN        | myGroup2                     |                                                                 | postgres
   10060 | LOCK_GROUP         | END          | myGroup2                     | 6 tables locked, 0 deadlock(s)                                  | postgres
   10061 | SET_MARK_GROUP     | END          | myGroup2                     | After restore mark                                              | postgres
   10062 | ROLLBACK_GROUP     | BEGIN        | myGroup2                     | Unlogged rollback to mark Multi-1 (timestamp)                   | postgres
   10063 | DBLINK_OPEN_CNX    |              | rlbk#1                       | Status = -2                                                     | postgres
   10064 | LOCK_GROUP         | BEGIN        | myGroup2                     | Rollback session #1                                             | postgres
   10065 | LOCK_GROUP         | END          | myGroup2                     | Rollback session #1: 6 tables locked, 0 deadlock(s)             | postgres
   10066 | ROLLBACK_TABLE     | BEGIN        | myschema2.mytbl6             | All log rows with emaj_gid > 100161 and <= 100659               | postgres
   10067 | ROLLBACK_TABLE     | END          | myschema2.mytbl6             | 14 rolled back primary keys                                     | postgres
   10068 | ROLLBACK_TABLE     | BEGIN        | myschema2.mytbl1             | All log rows with emaj_gid > 100161 and <= 100659               | postgres
   10069 | ROLLBACK_TABLE     | END          | myschema2.mytbl1             | 21 rolled back primary keys                                     | postgres
   10070 | ROLLBACK_TABLE     | BEGIN        | myschema2.mytbl2             | All log rows with emaj_gid > 100161 and <= 100659               | postgres
   10071 | ROLLBACK_TABLE     | END          | myschema2.mytbl2             | 3 rolled back primary keys                                      | postgres
   10072 | ROLLBACK_TABLE     | BEGIN        | myschema2.mytbl4             | All log rows with emaj_gid > 100161 and <= 100659               | postgres
   10073 | ROLLBACK_TABLE     | END          | myschema2.mytbl4             | 2 rolled back primary keys                                      | postgres
   10074 | ROLLBACK_TABLE     | BEGIN        | myschema2."myTbl3"           | All log rows with emaj_gid > 100161 and <= 100659               | postgres
   10075 | ROLLBACK_TABLE     | END          | myschema2."myTbl3"           | 10 rolled back primary keys                                     | postgres
   10076 | ROLLBACK_TABLE     | BEGIN        | myschema2.mytbl5             | All log rows with emaj_gid > 100161 and <= 100659               | postgres
   10077 | ROLLBACK_TABLE     | END          | myschema2.mytbl5             | 3 rolled back primary keys                                      | postgres
   10078 | ROLLBACK_GROUP     | MARK DELETED | myGroup2                     | mark RLBK_Multi-1_%_START is deleted                            | postgres
   10079 | ROLLBACK_GROUP     | MARK DELETED | myGroup2                     | mark RLBK_Multi-1_%_DONE is deleted                             | postgres
   10080 | ROLLBACK_GROUP     | MARK DELETED | myGroup2                     | mark After restore mark is deleted                              | postgres
   10081 | ROLLBACK_SEQUENCE  |              | myschema2.myseq1             | RESTART 1004                                                    | postgres
   10082 | ROLLBACK_SEQUENCE  |              | myschema2."myTbl3_col31_seq" | RESTART 21                                                      | postgres
   10083 | ROLLBACK_GROUP     | END          | myGroup2                     | Rollback_id 202, 6 tables and 2 sequences effectively processed | postgres
   10084 | STOP_GROUP         | BEGIN        | myGroup2                     |                                                                 | postgres
   10085 | LOCK_GROUP         | BEGIN        | myGroup2                     |                                                                 | postgres
   10086 | LOCK_GROUP         | END          | myGroup2                     | 6 tables locked, 0 deadlock(s)                                  | postgres
   10087 | SET_MARK_GROUP     | BEGIN        | myGroup2                     | STOP_%                                                          | postgres
   10088 | SET_MARK_GROUP     | END          | myGroup2                     | STOP_%                                                          | postgres
   10089 | STOP_GROUP         | END          | myGroup2                     | 8 tables/sequences processed                                    | postgres
(89 rows)

--
truncate emaj.emaj_hist;
TRUNCATE TABLE
alter sequence emaj.emaj_hist_hist_id_seq restart 10000;
ALTER SEQUENCE

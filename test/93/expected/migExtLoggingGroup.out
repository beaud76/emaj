-- migExtLoggingGroup.sql : Upgrade from E-Maj 1.3. to next_version while groups are in logging state.
--
-----------------------------
-- emaj update to next_version
-----------------------------
--\! cp /usr/local/pg912/share/postgresql/extension/emaj.control.0.12.0 /usr/local/pg912/share/postgresql/extension/emaj.control
-- check the extension is available
select * from pg_available_extension_versions where name = 'emaj';
 name |   version    | installed | superuser | relocatable | schema | requires |                                            comment                                             
------+--------------+-----------+-----------+-------------+--------+----------+------------------------------------------------------------------------------------------------
 emaj | next_version | f         | t         | f           | emaj   | {dblink} | E-Maj extension enables fine-grained write logging and time travel on subsets of the database.
(1 row)

-- process the extension upgrade
ALTER EXTENSION emaj UPDATE TO 'next_version';
NOTICE:  drop cascades to 2 other objects
DETAIL:  drop cascades to constraint emaj_relation_rel_group_fkey on table emaj_relation
drop cascades to constraint emaj_mark_mark_group_fkey on table emaj_mark
NOTICE:  drop cascades to 2 other objects
DETAIL:  drop cascades to constraint emaj_rlbk_session_rlbs_rlbk_id_fkey on table emaj_rlbk_session
drop cascades to constraint emaj_rlbk_plan_rlbp_rlbk_id_fkey on table emaj_rlbk_plan
NOTICE:  event trigger "emaj_protection_trg" does not exist, skipping
CONTEXT:  SQL statement "
DROP EVENT TRIGGER IF EXISTS emaj_protection_trg;
CREATE EVENT TRIGGER emaj_protection_trg
  ON sql_drop
  WHEN TAG IN ('DROP EXTENSION','DROP SCHEMA')
  EXECUTE PROCEDURE public._emaj_protection_event_trigger_fnct();
"
PL/pgSQL function inline_code_block line 39 at EXECUTE statement
NOTICE:  event trigger "emaj_sql_drop_trg" does not exist, skipping
CONTEXT:  SQL statement "
DROP EVENT TRIGGER IF EXISTS emaj_sql_drop_trg;
CREATE EVENT TRIGGER emaj_sql_drop_trg
  ON sql_drop
  WHEN TAG IN ('DROP FUNCTION','DROP SCHEMA','DROP SEQUENCE','DROP TABLE','DROP TRIGGER')
  EXECUTE PROCEDURE emaj._event_trigger_sql_drop_fnct();
"
PL/pgSQL function inline_code_block line 152 at EXECUTE statement
-----------------------------
-- check installation
-----------------------------
-- check impact in catalog
select extname, extversion from pg_extension where extname = 'emaj';
 extname |  extversion  
---------+--------------
 emaj    | next_version
(1 row)

-- check the emaj_param content
SELECT param_value_text FROM emaj.emaj_param WHERE param_key = 'emaj_version';
 param_value_text 
------------------
 2.0.0
(1 row)

-----------------------------
-- Check the tables and sequences after upgrade
-----------------------------
-- emaj tables and sequences
select time_id, time_last_emaj_gid, time_event from emaj.emaj_time_stamp order by time_id;
 time_id | time_last_emaj_gid | time_event 
---------+--------------------+------------
       1 |                    | C
       2 |                    | C
       3 |                    | C
       4 |                  0 | M
       5 |                  0 | M
       6 |                  0 | M
       7 |                 29 | M
       8 |                 40 | M
       9 |                    | R
      10 |                    | R
      11 |                 77 | M
      12 |                 81 | M
      13 |                    | R
      14 |                 81 | M
      15 |                 83 | M
      16 |                    | R
      17 |                 83 | M
      18 |                 85 | M
      19 |                 85 | M
(19 rows)

select last_value, is_called from emaj.emaj_time_stamp_time_id_seq;
 last_value | is_called 
------------+-----------
         19 | t
(1 row)

select group_name, group_is_logging, group_is_rlbk_protected, group_nb_table, group_nb_sequence, group_is_rollbackable, 
       group_creation_time_id, group_last_alter_time_id, group_comment
  from emaj.emaj_group order by group_name;
    group_name    | group_is_logging | group_is_rlbk_protected | group_nb_table | group_nb_sequence | group_is_rollbackable | group_creation_time_id | group_last_alter_time_id | group_comment 
------------------+------------------+-------------------------+----------------+-------------------+-----------------------+------------------------+--------------------------+---------------
 myGroup1         | t                | t                       |              5 |                 1 | t                     |                      1 |                          | 
 myGroup2         | t                | f                       |              4 |                 2 | t                     |                      2 |                          | 
 phil's group#3", | t                | t                       |              2 |                 1 | f                     |                      3 |                          | 
(3 rows)

select mark_id, mark_group, regexp_replace(mark_name,E'\\d\\d\.\\d\\d\\.\\d\\d\\.\\d\\d\\d','%','g'), 
       mark_time_id, mark_is_deleted, mark_is_rlbk_protected, mark_comment, 
       mark_log_rows_before_next, mark_logged_rlbk_target_mark 
  from emaj.emaj_mark order by mark_id;
 mark_id |    mark_group    | regexp_replace  | mark_time_id | mark_is_deleted | mark_is_rlbk_protected |  mark_comment  | mark_log_rows_before_next | mark_logged_rlbk_target_mark 
---------+------------------+-----------------+--------------+-----------------+------------------------+----------------+---------------------------+------------------------------
       1 | myGroup1         | M1              |            4 | f               | f                      |                |                        29 | 
       2 | myGroup2         | M1              |            5 | f               | f                      |                |                        27 | 
       3 | phil's group#3", | M1              |            6 | f               | f                      |                |                           | 
       4 | myGroup1         | M2              |            7 | f               | f                      |                |                        11 | 
       5 | myGroup1         | M3              |            8 | f               | t                      | Third mark set |                         0 | 
       6 | myGroup2         | M2              |           11 | f               | f                      |                |                         4 | 
       7 | myGroup2         | M3              |           12 | f               | f                      |                |                         0 | 
       8 | myGroup2         | RLBK_M2_%_START |           14 | f               | f                      |                |                         2 | 
       9 | myGroup2         | RLBK_M2_%_DONE  |           15 | f               | f                      |                |                         0 | 
      10 | myGroup2         | RLBK_M3_%_START |           17 | f               | f                      |                |                         2 | 
      11 | myGroup2         | RLBK_M3_%_DONE  |           18 | f               | f                      |                |                         0 | 
      12 | myGroup1         | Common          |           19 | f               | f                      |                |                           | 
      13 | myGroup2         | Common          |           19 | f               | f                      |                |                           | 
(13 rows)

select last_value, is_called from emaj.emaj_mark_mark_id_seq;
 last_value | is_called 
------------+-----------
         13 | t
(1 row)

select sequ_schema, sequ_name, sequ_time_id, sequ_last_val, sequ_start_val, sequ_increment, sequ_max_val, sequ_min_val, sequ_cache_val, sequ_is_cycled, sequ_is_called from emaj.emaj_sequence order by sequ_time_id, sequ_schema, sequ_name;
  sequ_schema   |             sequ_name              | sequ_time_id | sequ_last_val | sequ_start_val | sequ_increment |    sequ_max_val     | sequ_min_val | sequ_cache_val | sequ_is_cycled | sequ_is_called 
----------------+------------------------------------+--------------+---------------+----------------+----------------+---------------------+--------------+----------------+----------------+----------------
 emaj           | myschema1_mytbl1_log_seq           |            4 |             1 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | f
 emaj           | myschema1_mytbl2b_log_seq          |            4 |             1 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | f
 emaj           | myschema1_mytbl2_log_seq           |            4 |             1 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | f
 emaj           | myschema1_myTbl3_log_seq           |            4 |             1 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | f
 emaj           | myschema1_mytbl4_log_seq           |            4 |             1 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | f
 myschema1      | myTbl3_col31_seq                   |            4 |             1 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | f
 emaj           | myschema2_mytbl1_log_seq           |            5 |             1 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | f
 emaj           | myschema2_mytbl2_log_seq           |            5 |             1 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | f
 emaj           | myschema2_myTbl3_log_seq           |            5 |             1 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | f
 emaj           | myschema2_mytbl4_log_seq           |            5 |             1 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | f
 myschema2      | myseq1                             |            5 |          1000 |           1000 |              1 |                2000 |         1000 |              1 | t              | f
 myschema2      | myTbl3_col31_seq                   |            5 |             1 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | f
 emaj           | phil's schema3_myTbl2\_log_seq     |            6 |             1 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | f
 emaj           | phil's schema3_phil's tbl1_log_seq |            6 |             1 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | f
 phil's schema3 | phil's seq\1                       |            6 |          1000 |           1000 |              1 |                2000 |         1000 |              1 | t              | f
 emaj           | myschema1_mytbl1_log_seq           |            7 |            15 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema1_mytbl2b_log_seq          |            7 |             2 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema1_mytbl2_log_seq           |            7 |             2 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema1_myTbl3_log_seq           |            7 |            10 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema1_mytbl4_log_seq           |            7 |             1 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | f
 myschema1      | myTbl3_col31_seq                   |            7 |            10 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema1_mytbl1_log_seq           |            8 |            18 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema1_mytbl2b_log_seq          |            8 |             2 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema1_mytbl2_log_seq           |            8 |             2 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema1_myTbl3_log_seq           |            8 |            10 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema1_mytbl4_log_seq           |            8 |             8 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 myschema1      | myTbl3_col31_seq                   |            8 |            10 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema2_mytbl1_log_seq           |           11 |            15 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema2_mytbl2_log_seq           |           11 |             2 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema2_myTbl3_log_seq           |           11 |            10 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema2_mytbl4_log_seq           |           11 |             1 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | f
 myschema2      | myseq1                             |           11 |          1000 |           1000 |              1 |                2000 |         1000 |              1 | t              | t
 myschema2      | myTbl3_col31_seq                   |           11 |            10 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema2_mytbl1_log_seq           |           12 |            15 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema2_mytbl2_log_seq           |           12 |             2 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema2_myTbl3_log_seq           |           12 |            10 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema2_mytbl4_log_seq           |           12 |             4 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 myschema2      | myseq1                             |           12 |          1003 |           1000 |              1 | 9223372036854775807 |         1000 |              1 | f              | t
 myschema2      | myTbl3_col31_seq                   |           12 |            10 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema2_mytbl1_log_seq           |           14 |            15 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema2_mytbl2_log_seq           |           14 |             2 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema2_myTbl3_log_seq           |           14 |            10 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema2_mytbl4_log_seq           |           14 |             4 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 myschema2      | myseq1                             |           14 |          1003 |           1000 |              1 | 9223372036854775807 |         1000 |              1 | f              | t
 myschema2      | myTbl3_col31_seq                   |           14 |            10 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema2_mytbl1_log_seq           |           15 |            15 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema2_mytbl2_log_seq           |           15 |             2 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema2_myTbl3_log_seq           |           15 |            10 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema2_mytbl4_log_seq           |           15 |             6 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 myschema2      | myseq1                             |           15 |          1001 |           1000 |              1 |                2000 |         1000 |              1 | t              | f
 myschema2      | myTbl3_col31_seq                   |           15 |            10 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema2_mytbl1_log_seq           |           17 |            15 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema2_mytbl2_log_seq           |           17 |             2 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema2_myTbl3_log_seq           |           17 |            10 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema2_mytbl4_log_seq           |           17 |             6 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 myschema2      | myseq1                             |           17 |          1001 |           1000 |              1 |                2000 |         1000 |              1 | t              | f
 myschema2      | myTbl3_col31_seq                   |           17 |            10 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema2_mytbl1_log_seq           |           18 |            15 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema2_mytbl2_log_seq           |           18 |             2 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema2_myTbl3_log_seq           |           18 |            10 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema2_mytbl4_log_seq           |           18 |             8 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 myschema2      | myseq1                             |           18 |          1004 |           1000 |              1 | 9223372036854775807 |         1000 |              1 | f              | f
 myschema2      | myTbl3_col31_seq                   |           18 |            10 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema1_mytbl1_log_seq           |           19 |            24 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema1_mytbl2b_log_seq          |           19 |             4 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema1_mytbl2_log_seq           |           19 |             3 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema1_myTbl3_log_seq           |           19 |            10 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema1_mytbl4_log_seq           |           19 |             9 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema2_mytbl1_log_seq           |           19 |            15 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema2_mytbl2_log_seq           |           19 |             2 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema2_myTbl3_log_seq           |           19 |            10 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 emaj           | myschema2_mytbl4_log_seq           |           19 |             8 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 myschema1      | myTbl3_col31_seq                   |           19 |            10 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
 myschema2      | myseq1                             |           19 |          1004 |           1000 |              1 | 9223372036854775807 |         1000 |              1 | f              | f
 myschema2      | myTbl3_col31_seq                   |           19 |            10 |              1 |              1 | 9223372036854775807 |            1 |              1 | f              | t
(75 rows)

select * from emaj.emaj_seq_hole order by sqhl_schema, sqhl_table, sqhl_begin_time_id;
 sqhl_schema | sqhl_table | sqhl_begin_time_id | sqhl_end_time_id | sqhl_hole_size 
-------------+------------+--------------------+------------------+----------------
 myschema1   | mytbl1     |                  8 |               11 |              6
 myschema1   | mytbl2     |                  8 |               11 |              1
 myschema1   | mytbl2b    |                  8 |               11 |              2
 myschema1   | mytbl4     |                  8 |               11 |              1
(4 rows)

select rlbk_id, rlbk_groups, rlbk_mark, rlbk_time_id, rlbk_is_logged, rlbk_nb_session, rlbk_nb_table, rlbk_nb_sequence, rlbk_eff_nb_table, rlbk_status, rlbk_begin_hist_id, rlbk_is_dblink_used, rlbk_msg from emaj.emaj_rlbk order by rlbk_id;
 rlbk_id | rlbk_groups | rlbk_mark | rlbk_time_id | rlbk_is_logged | rlbk_nb_session | rlbk_nb_table | rlbk_nb_sequence | rlbk_eff_nb_table | rlbk_status | rlbk_begin_hist_id | rlbk_is_dblink_used |                         rlbk_msg                          
---------+-------------+-----------+--------------+----------------+-----------------+---------------+------------------+-------------------+-------------+--------------------+---------------------+-----------------------------------------------------------
       1 | {myGroup1}  | M3        |            9 | f              |               1 |             5 |                1 |                 1 | COMMITTED   |                 36 | f                   | Completed: 1 tables and 1 sequences effectively processed
       2 | {myGroup1}  | M3        |           10 | f              |               1 |             5 |                1 |                 3 | COMMITTED   |                 44 | f                   | Completed: 3 tables and 1 sequences effectively processed
       3 | {myGroup2}  | M2        |           13 | t              |               1 |             4 |                2 |                 1 | COMMITTED   |                 66 | f                   | Completed: 1 tables and 2 sequences effectively processed
       4 | {myGroup2}  | M3        |           16 | t              |               1 |             4 |                2 |                 1 | COMMITTED   |                 79 | f                   | Completed: 1 tables and 2 sequences effectively processed
(4 rows)

select last_value, is_called from emaj.emaj_rlbk_rlbk_id_seq;
 last_value | is_called 
------------+-----------
          4 | t
(1 row)

-- log tables
select col11, col12, col13, emaj_verb, emaj_tuple, emaj_gid from emaj.mySchema1_myTbl1_log order by emaj_gid, emaj_tuple desc;
 col11 |   col12    | col13 | emaj_verb | emaj_tuple | emaj_gid 
-------+------------+-------+-----------+------------+----------
     1 | ABC        | \x0c  | INS       | NEW        |        1
     2 | ABC        | \x0c  | INS       | NEW        |        2
     3 | ABC        | \x0c  | INS       | NEW        |        3
     4 | ABC        | \x0c  | INS       | NEW        |        4
     5 | ABC        | \x0c  | INS       | NEW        |        5
     6 | ABC        | \x0c  | INS       | NEW        |        6
     7 | ABC        | \x0c  | INS       | NEW        |        7
     8 | ABC        | \x0c  | INS       | NEW        |        8
     9 | ABC        | \x0c  | INS       | NEW        |        9
    10 | ABC        | \x0c  | INS       | NEW        |       10
    11 | ABC        | \x0c  | INS       | NEW        |       11
     1 | ABC        | \x0c  | UPD       | OLD        |       12
     1 | ABC        | \x1c  | UPD       | NEW        |       12
     2 | ABC        | \x0c  | UPD       | OLD        |       13
     2 | ABC        | \x1c  | UPD       | NEW        |       13
     3 | ABC        | \x0c  | UPD       | OLD        |       14
     3 | ABC        | \x1c  | UPD       | NEW        |       14
    11 | ABC        | \x0c  | DEL       | OLD        |       17
    10 | ABC        | \x0c  | DEL       | OLD        |       35
     1 | ABC        | \x1c  | UPD       | OLD        |       37
     1 | DEF        | \x1c  | UPD       | NEW        |       37
     2 | ABC        | \x1c  | UPD       | OLD        |       38
     2 | DEF        | \x1c  | UPD       | NEW        |       38
(23 rows)

select col21, col22, col23, emaj_verb, emaj_tuple, emaj_gid from emaj.mySchema1_myTbl2_log order by emaj_gid, emaj_tuple desc;
 col21 | col22 |   col23    | emaj_verb | emaj_tuple | emaj_gid 
-------+-------+------------+-----------+------------+----------
     1 | ABC   | 12-31-2010 | INS       | NEW        |       15
     2 | DEF   |            | INS       | NEW        |       18
(2 rows)

select col20, col21, emaj_verb, emaj_tuple, emaj_gid from emaj.mySchema1_myTbl2b_log order by emaj_gid, emaj_tuple desc;
 col20 | col21 | emaj_verb | emaj_tuple | emaj_gid 
-------+-------+-----------+------------+----------
     1 |     1 | INS       | NEW        |       16
     2 |     2 | INS       | NEW        |       19
(2 rows)

select col31, col33, emaj_verb, emaj_tuple, emaj_gid from emaj."myschema1_myTbl3_log" order by emaj_gid, emaj_tuple desc;
 col31 | col33 | emaj_verb | emaj_tuple | emaj_gid 
-------+-------+-----------+------------+----------
     1 | 10.00 | INS       | NEW        |       20
     2 | 10.00 | INS       | NEW        |       21
     3 | 10.00 | INS       | NEW        |       22
     4 | 10.00 | INS       | NEW        |       23
     5 | 10.00 | INS       | NEW        |       24
     6 | 10.00 | INS       | NEW        |       25
     7 | 10.00 | INS       | NEW        |       26
     8 | 10.00 | INS       | NEW        |       27
     9 | 10.00 | INS       | NEW        |       28
    10 | 10.00 | INS       | NEW        |       29
(10 rows)

select col41, col42, col43, col44, col45, emaj_verb, emaj_tuple, emaj_gid from emaj.mySchema1_myTbl4_log order by emaj_gid, emaj_tuple desc;
 col41 | col42 | col43 | col44 |   col45    | emaj_verb | emaj_tuple | emaj_gid 
-------+-------+-------+-------+------------+-----------+------------+----------
     1 | FK... |     1 |     1 | ABC        | INS       | NEW        |       30
     2 | FK... |     1 |     1 | ABC        | INS       | NEW        |       31
     1 | FK... |     1 |     1 | ABC        | UPD       | OLD        |       32
     1 | FK... |     2 |     1 | ABC        | UPD       | NEW        |       32
     2 | FK... |     1 |     1 | ABC        | UPD       | OLD        |       33
     2 | FK... |     2 |     1 | ABC        | UPD       | NEW        |       33
     3 | FK... |     1 |    10 | ABC        | INS       | NEW        |       34
     3 | FK... |     1 |    10 | ABC        | DEL       | OLD        |       36
     1 | FK... |     2 |     1 | ABC        | UPD       | OLD        |       39
     1 | FK... |     2 |       |            | UPD       | NEW        |       39
     2 | FK... |     2 |     1 | ABC        | UPD       | OLD        |       40
     2 | FK... |     2 |       |            | UPD       | NEW        |       40
(12 rows)

--
select col11, col12, col13, emaj_verb, emaj_tuple, emaj_gid from emaj.mySchema2_myTbl1_log order by emaj_gid, emaj_tuple desc;
 col11 |   col12    | col13 | emaj_verb | emaj_tuple | emaj_gid 
-------+------------+-------+-----------+------------+----------
     1 | ABC        | \x0c  | INS       | NEW        |       51
     2 | ABC        | \x0c  | INS       | NEW        |       52
     3 | ABC        | \x0c  | INS       | NEW        |       53
     4 | ABC        | \x0c  | INS       | NEW        |       54
     5 | ABC        | \x0c  | INS       | NEW        |       55
     6 | ABC        | \x0c  | INS       | NEW        |       56
     7 | ABC        | \x0c  | INS       | NEW        |       57
     8 | ABC        | \x0c  | INS       | NEW        |       58
     9 | ABC        | \x0c  | INS       | NEW        |       59
    10 | ABC        | \x0c  | INS       | NEW        |       60
    11 | ABC        | \x0c  | INS       | NEW        |       61
     1 | ABC        | \x0c  | UPD       | OLD        |       62
     1 | ABC        | \x1c  | UPD       | NEW        |       62
     2 | ABC        | \x0c  | UPD       | OLD        |       63
     2 | ABC        | \x1c  | UPD       | NEW        |       63
     3 | ABC        | \x0c  | UPD       | OLD        |       64
     3 | ABC        | \x1c  | UPD       | NEW        |       64
    11 | ABC        | \x0c  | DEL       | OLD        |       66
(18 rows)

select col21, col22, col23, emaj_verb, emaj_tuple, emaj_gid from emaj.mySchema2_myTbl2_log order by emaj_gid, emaj_tuple desc;
 col21 | col22 |   col23    | emaj_verb | emaj_tuple | emaj_gid 
-------+-------+------------+-----------+------------+----------
     1 | ABC   | 01-01-2010 | INS       | NEW        |       65
     2 | DEF   |            | INS       | NEW        |       67
(2 rows)

select col31, col33, emaj_verb, emaj_tuple, emaj_gid from emaj."myschema2_myTbl3_log" order by emaj_gid, emaj_tuple desc;
 col31 | col33 | emaj_verb | emaj_tuple | emaj_gid 
-------+-------+-----------+------------+----------
     1 | 10.00 | INS       | NEW        |       68
     2 | 10.00 | INS       | NEW        |       69
     3 | 10.00 | INS       | NEW        |       70
     4 | 10.00 | INS       | NEW        |       71
     5 | 10.00 | INS       | NEW        |       72
     6 | 10.00 | INS       | NEW        |       73
     7 | 10.00 | INS       | NEW        |       74
     8 | 10.00 | INS       | NEW        |       75
     9 | 10.00 | INS       | NEW        |       76
    10 | 10.00 | INS       | NEW        |       77
(10 rows)

select col41, col42, col43, col44, col45, emaj_verb, emaj_tuple, emaj_gid from emaj.mySchema2_myTbl4_log order by emaj_gid, emaj_tuple desc;
 col41 | col42 | col43 | col44 |   col45    | emaj_verb | emaj_tuple | emaj_gid 
-------+-------+-------+-------+------------+-----------+------------+----------
     1 | FK... |     1 |     1 | ABC        | INS       | NEW        |       78
     2 | FK... |     1 |     1 | ABC        | INS       | NEW        |       79
     1 | FK... |     1 |     1 | ABC        | UPD       | OLD        |       80
     1 | FK... |     2 |     1 | ABC        | UPD       | NEW        |       80
     2 | FK... |     1 |     1 | ABC        | UPD       | OLD        |       81
     2 | FK... |     2 |     1 | ABC        | UPD       | NEW        |       81
     1 | FK... |     2 |     1 | ABC        | DEL       | OLD        |       82
     2 | FK... |     2 |     1 | ABC        | DEL       | OLD        |       83
     1 | FK... |     2 |     1 | ABC        | INS       | NEW        |       84
     2 | FK... |     2 |     1 | ABC        | INS       | NEW        |       85
(10 rows)

